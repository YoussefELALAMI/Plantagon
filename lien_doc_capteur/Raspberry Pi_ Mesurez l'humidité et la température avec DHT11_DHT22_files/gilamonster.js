var ezVideoAnalytics;(()=>{"use strict";var e={d:(t,i)=>{for(var a in i)e.o(i,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:i[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function i(e){for(var t=e+"=",i=decodeURIComponent(document.cookie).split(";"),a=0;a<i.length;a++){for(var d=i[a];" "==d.charAt(0);)d=d.substring(1);if(0==d.indexOf(t))return d.substring(t.length,d.length)}return""}function a(){var e={};return"undefined"!==typeof videoID&&(e.content_id=videoID),"undefined"!==typeof title&&(e.video_title=title),e.uuid=function(){var e=(new Date).getTime();return e+=performance.now(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}(),e.total_play_time=0,e.play_cnt=0,e.pause_cnt=0,e.ad_cnt=0,e.seek_time=0,e.completed=!1,e.errored=!1,e.removed=!1,e.muted=!1,e.seek_back_click=0,e.seek_forward_click=-1,e.seek_back_scrubbing=0,e.seek_forward_scrubbing=0,e.timeupdatecalls=0,e}function d(e){if(!e||0===Object.keys(e).length)return!1;if("undefined"!==typeof _ezaq&&_ezaq.domain_id){const t=_ezaq.domain_id;if(e.DomainIdOwner&&e.DomainIdOwner!==t)return!0}return!1}function s(){return"undefined"!==typeof _ezaq&&"undefined"!==typeof _ezaq.form_factor_id?2==_ezaq.form_factor_id||3==_ezaq.form_factor_id:"undefined"!==typeof ezoFormfactor&&("2"==ezoFormfactor||"3"==ezoFormfactor)}function r(){if(function(){const e=new URLSearchParams(window.location.search).get("ez_vid_debug");return"1"===e||"2"===e}()){let e=Array.from(arguments);e.unshift("[Video Ads]"),console.log.apply(console,e)}}function n(e){let t=[],i=e;for(;null!==i;)t.push(i.toString()),i="innerError"in i?i.innerError():null;return t.join("; inner error: ").substring(0,256)}e.r(t),e.d(t,{NewAnalyticsPlayer:()=>W,NewPrebidVideoAdInitializer:()=>G,NewVideoAdInitializer:()=>Q});class o{constructor(e,t,i,a){r("VideoAdInitializer constructor called"),this.videoPlayer_=e,google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(i),google.ima.settings.setNumRedirects(8),this.videoAdContainerId="ez-video-ad-container-"+t.PlayerId;let d=document.getElementById(this.videoAdContainerId);if(!d)return void r("Ad container missing or deleted, not loading ads");google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.adDisplayContainer_=new google.ima.AdDisplayContainer(d,this.videoPlayer_.getVideoElement()),this.adsLoader_=new google.ima.AdsLoader(this.adDisplayContainer_),this.adsManager_=null,this.containerInitialized=!1;let s=!1,n=!1;a&&(s=a.autoplay_allowed,n=a.autoplay_allowed_muted),t.IsAutoPlay&&(s||n)&&this.initializeContainer()}initializeContainer(){this.containerInitialized=!0,this.adDisplayContainer_.initialize()}isContainerInitialized(){return this.containerInitialized}attachAdEventListener(e,t,i){this.adsLoader_.addEventListener(e,t,!1,i)}isEmbeddedPlayer(){return"undefined"!==typeof vectx||"undefined"!==typeof magicOutstreamCtx}}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}function u(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)}function _(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||c()||navigator.userAgent.match(/Opera Mini/i)||navigator.userAgent.match(/IEMobile/i)}new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});const v="450px",g=["div","span","p","article","section","aside","main","ul","ol","h1","h2","h3","h4","h5","h6","table"],p=["header","footer","li","form","nav","script","code","pre","picture","figure","video"],m=["header","navbar","top-bar","site-header","main-navigation","footer","site-footer","bottom-bar","footer-nav","footer-widgets","menu","nav-menu","main-menu","dropdown-menu","side-menu"],y=["footer",".footer-nav",".footer-widgets",".site-footer",".footer"];"undefined"!==typeof ezVideoAdConductor&&ezVideoAdConductor.getVideoAdConductor();async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=document.createElement("span");function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;!function(){if(window.EzoicMagicPlayerExclusionSelectors)for(var e=0;e<window.EzoicMagicPlayerExclusionSelectors.length;e++)try{for(var t=document.querySelectorAll(window.EzoicMagicPlayerExclusionSelectors[e]),i=0;i<t.length;i++)t[i].setAttribute("data-ezoic-video-excluded","1")}catch(d){b("magic: Invalid selector:",window.EzoicMagicPlayerExclusionSelectors[e],"; Error:",d)}try{t=document.querySelectorAll('[id^="ezoic-pub-ad-placeholder-"], .ezoic-ad.adtester-container');var a=Array.from(t).filter((e=>!e.hasAttribute("data-ezhumixplayerlocation")));for(e=0;e<a.length;e++)a[e].setAttribute("data-ezoic-video-excluded","1")}catch(d){b("magic: Invalid selector when excluding ezoic ads spans, Error:",d)}try{for(t=document.querySelectorAll("[data-ez-ph-id]"),e=0;e<t.length;e++)t[e].setAttribute("data-ezoic-video-excluded","1")}catch(d){b("magic: Invalid selector when excluding ezoic ads elements, Error:",d)}}(),function(){if(window.EzoicMagicPlayerInclusionSelectors)for(var e=0;e<window.EzoicMagicPlayerInclusionSelectors.length;e++)try{for(var t=document.querySelectorAll(window.EzoicMagicPlayerInclusionSelectors[e]),i=0;i<t.length;i++)t[i].setAttribute("data-ezoic-video-included","1")}catch(a){b("magic: Invalid selector:",window.EzoicMagicPlayerInclusionSelectors[e],"; Error:",a)}(t=document.querySelectorAll("[data-ezhumixplayerlocation]")).forEach((e=>{e.setAttribute("data-ezoic-video-included","1")}))}();var t=null,i=9999999999;let a=400;_()&&(a=400);var d=document.querySelectorAll(".ez-video-placeholder-marker, [data-ezhumixplayerlocation]"),s=e||window.EzoicPreferredLocation||1;b("magic: preferredViewports",s=function(e){if("URLSearchParams"in window){return new URLSearchParams(window.location.search).get(e)||null}return null}("ez_magic_viewports")||s);var n=window.innerHeight*s,o=Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.body.scrollHeight);n>o&&(b("magic: the document is too short for the preferred height, placing at the end of the document"),n=o-200),b("magic: preferredHeight",n,"window.innerHeight",window.innerHeight,"pageHeight",o,"preferredViewports",s);var l=n-.5*a;let h=function(){let e=2==window._ezaq.form_factor_id;if(!e)return b("featured image not relevant. this is not mobile"),null;let t=document.querySelectorAll('meta[name="robots"]'),i=!1;for(let r=0;r<t.length;r++){let e=t[r].getAttribute("content");if(e&&e.includes("max-image-preview:large")){i=!0;break}}if(!i)return b("does not have large image preview setting enabled"),null;const a=[".entry-header img",".td-post-featured-image img",".article__gallery img","img.wp-post-image",".article__cover img",".gallery__image_picture img",".et_pb_title_featured_container img",".featured-image img","img.featured",".post-thumbnail img",".post-header img",".cover-image img",".hero img",".banner img",".post > img:only-child",".article > img:only-child",".main > img:only-child","header img","figure.wp-block-image img","figure.wp-block-cover img",'img[data-featured="true"]','img[rel="featured"]'],d=2*window.innerHeight;let s=[];if(a.forEach((e=>{const t=document.querySelectorAll(e);s=s.concat(Array.from(t))})),s=[...new Set(s)],0===s.length)return b("no images found in the query"),null;if(s=s.filter((e=>{const t=e.getBoundingClientRect(),i=window.pageYOffset||document.documentElement.scrollTop||0,a=t.top+i;if(a>d)return b("filtered out img: ",e,` imageTopPosition: ${a}, positionThreshold: ${d}`),!1;const s=e.naturalWidth/e.naturalHeight;return t.width>200&&t.height>180&&s>.5&&!e.classList.contains("avatar")&&!e.classList.contains("icon")&&!e.closest(".thumbnails, .sidebar, .footer")})),0===s.length)return console.log("no suitable images after filtering"),null;return s.sort(((e,t)=>{const i=e.getBoundingClientRect(),a=t.getBoundingClientRect();return i.top+i.left-(a.top+a.left)})),s[0]}();if(h){let e=h.getBoundingClientRect(),t=Math.max(l,e.bottom+window.scrollY),i=Math.round(t-l),a=Math.round(l);window._ezaq&&window.__ez&&window.__ez.bit&&__ez.bit.Add(_ezaq.page_view_id,[new __ezDotData("delta_target_hmx_feat_img",i),new __ezDotData("old_target_hmx_feat_img",a)]),b("featured image identified was",h,`old target position: ${l}. new: ${t}`),l=t}else b("no featured image on the page",h);var u=n+a*(1+s),[t,i]=r(d,t,i,l);if(!t||i>u)var[t,i]=r(document.querySelectorAll("body *"),t,i,l);else b("magic: Found publisher placeholder that is good enough");return b("magic: found location. Will be placed at: element",t,"which has top position of:",i,"and needs to be below:",l),t}function d(e,t){let i=t.querySelectorAll("*").length,a=s(t,i,[]);if(0==a.length)return e;for(var d=[],r=0;r<a.length;r++){for(var n=!1,o=0;o<a.length;o++)if(r!=o&&a[r].contains(a[o])){n=!0;break}n||d.push(a[r])}var l=null;for(r=0;r<d.length;r++){var h=d[r].getBoundingClientRect();h.width>e&&(e=h.width,l=d[r])}return b("magic: content width is",e,l),e}function s(e,t,i){var a=e.querySelectorAll("*"),d=e.children,r=e.getBoundingClientRect();if(a.length>.33*t&&r.top<500&&!f(e)&&!c(e)){i.push(e);for(var n=0;n<d.length;n++)s(d[n],t,i)}return i}function r(e,t,i,a){let s=.4,r=450,v=400;_()&&(s=.7,r=384,v=250);const g=window.innerWidth;var p=d(0,document.body);b("magic: content width is ",p,"viewportWidth is ",g,"thresholdWidthMinPixels is ",v),p<v&&(b("magic: content width changed to viewport width"),p=g),b("getting min threshold width: ",s*g,r,.66*p);var m=Math.min(s*g,r,.66*p);m<v&&(m=v),b("magic: Finding element below fold with width! (pizza) >= "+m+"px and fold position >= "+a+"px");for(const d of e){const e=d.getBoundingClientRect();(d.hasAttribute("data-ezhumixplayerlocation")||d.classList.contains("ez-video-placeholder-marker"))&&(e.width=m),!(e.top>=a&&e.width>=m&&e.top<i&&u(d))||f(d)||h(d)||l(d)||c(d)||!n(d,a)||o(d)||(i=e.top,t=d)}return[t,i]}function n(e,t){for(const i of e.children){const e=i.getBoundingClientRect();if(!(0==e.width||0==e.height)&&e.top<t-100)return b("magic: dissalowed because child top: "+e.top+" < targetPosition-100: "+t),!1}return!0}function o(e){for(;e;){const t=window.getComputedStyle(e);if(parseInt(t.height)>450)return!1;if("none"!==t.backgroundImage)return!0;e=e.parentElement}return!1}function l(e){var t=e.getBoundingClientRect(),i=e.previousElementSibling;if(i){var a=i.getBoundingClientRect();if(t.top<a.bottom-30)return b("magic: dissalowed because element is overlapping: "+e),!0}return!1}function h(e){if(e.hasAttribute("data-ezoic-video-included")||e.classList.contains("ez-video-placeholder-marker"))return!1;let t=!window.EzoicMagicPlayerInclusionSelectors||0===window.EzoicMagicPlayerInclusionSelectors.length;for(;e;){if(!e.hasAttribute("data-ezoic-video-included")&&p.includes(e.tagName.toLowerCase())||e.hasAttribute("data-ezoic-video-excluded"))return!0;t=t||e.hasAttribute("data-ezoic-video-included");for(var i=0;i<m.length;i++)if(e.classList.contains(m[i]))return b("magic: dissalowed because element has disallowed class: "+e),!0;e=e.parentElement}return!t}function u(e){return!!g.includes(e.tagName.toLowerCase())}function c(e){for(;e;){var t=window.getComputedStyle(e);if(("fixed"===t.position||"sticky"===t.position||"absolute"===t.position)&&!e.hasAttribute("data-ezoic-video-included"))return b("magic: dissalowed because element is floating: "+e+" classes: "+e.classList),!0;e=e.parentElement}return!1}function f(e){var t=!(e.offsetWidth||e.offsetHeight||e.getClientRects().length);return t&&b("magic: dissalowed because element is invisible: "+e),t}function A(){const d=a(t);if(d&&d.parentNode){var s=!1;let t=window.getComputedStyle(d.parentNode),a=window.getComputedStyle(d);"grid"===t.display&&(s=!0,i.style="grid-column: 1/-1;"),(s=s||"grid"===t.display||"flex"===t.display)&&(b(`setting the order of the player's insert span to ${a.order}`),i.style.order=a.order),e instanceof Node?i.appendChild(e):i.innerHTML=e,d.parentNode.insertBefore(i,d);let r=function(e){if(!(e instanceof Element))throw new Error("Invalid input: not a DOM element");let t=e;for(;t.parentElement;){const i=t.parentElement;if(i.clientHeight<e.clientHeight){if("0px"!=window.getComputedStyle(i).height)return i}t=i}return null}(i);if(null!=r){if("0px"!=window.getComputedStyle(r).height){const e=5;b("magic: setting min height for ancestor element so that player doesn't overflow:",r),r.style.minHeight=e+r.scrollHeight+"px",P()&&(r.dataset.hmxplayer="added override to min height so that that the player won't overflow")}}return function(e){if(!e.hasAttribute("data-ezhumixplayerlocation"))return;for(;e.firstChild;)e.removeChild(e.firstChild);const t=e.id.match(/\d+$/)[0];document.querySelectorAll(`[data-ez-ph-id="${t}"]`).forEach((e=>{e.remove()}))}(d),function(e){if(!e.hasAttribute("data-ezhumixplayerlocation"))return;const t=e.parentElement;t.classList.contains("adslot")&&(t.classList.remove("adslot"),t.removeAttribute("id"))}(d),b("magic: Magic JS inserter placed magic player below fold",d),d.offsetWidth?parseInt(d.offsetWidth):parseInt(v)}if(!window.EzoicMagicPlayerInclusionSelectors||0===window.EzoicMagicPlayerInclusionSelectors.length){let t=!1;for(let e=0;e<y.length;e++){if(document.body.querySelector(y)){t=!0;break}}var r=window.EzoicPreferredLocation||1;if(!t&&1==r){let t=400;return _()&&(t=400),window.innerHeight-.5*t<Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.body.scrollHeight)&&(e instanceof Node?i.appendChild(e):i.innerHTML=e,b("magic: inserting to the end of the body, since there are no other good candidates"),document.body.appendChild(i)),document.body.offsetWidth?parseInt(document.body.offsetWidth):parseInt(v)}return b("magic: Magic JS inserter couldn't find a good element to insert into"),!1}}i.className="humix-universal-js-insert",i.style="display: block;padding:30px 0px;text-align:center;margin:0 auto;max-width:calc(min(768px, 100%))";let D=!1;var w;return D=A(),D||(await(w=300,new Promise((e=>setTimeout(e,w)))),b("magic: trying to place below fold again"),D=A()),D}async function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;for(var i=document.querySelectorAll('[id^="humix-vid-"]'),a=0;a<i.length;a++)for(var d=i[a].querySelectorAll("script"),s=0;s<d.length;s++)if(d[s].src.includes("humix.com"))return b("magic: found humix embed, not inserting magic player"),!1;b("Attempting to insert magic player",document.readyState);var r=await f(e,t);if(!!!r){let t=function(){let e=Array.from(document.querySelectorAll("span, div")).filter((e=>{const t=e.classList,i=e.id;return!(t.contains("under_page_title")||t.contains("top_of_page")||t.contains("sidebar")||t.contains("bottom_floating"))&&(t.contains("ezoic-autoinsert-video")||i.startsWith("ezoic-pub-video-placeholder-"))&&(!e.nextElementSibling||!e.nextElementSibling.id.startsWith("ez-video-wrap-"))}));return e.sort(((e,t)=>e.getBoundingClientRect().top-t.getBoundingClientRect().top)),e}();if(0==t.length)return b("No valid video nodes found for magic player, not inserting"),!1;b("Default inserting magic player into",t[0]),t[0].insertAdjacentHTML("afterend",e)}let n=parseInt(v);return n>r&&_()&&(n=r),Array.prototype.slice.call(document.querySelectorAll(".humix-universal-js-insert > .ez-video-wrap > .ez-video-center")).forEach((function(e){e.classList.contains("ez-playlist-vertical")||(e.style.maxWidth=n+"px")})),!0}function P(){return"1"===new URLSearchParams(window.location.search).get("ez_vid_autoinsert_debug")}function b(){if(P()){let e=Array.from(arguments);e.unshift("[Video Player]"),console.log.apply(console,e)}}window.hasEzChromeExtListener||(window.addEventListener("message",(e=>{if(e.origin!==window.location.origin)return;const t=e.data;"insertHTMLBelowFold"===t.action&&A(t.html,t.viewport)})),window.hasEzChromeExtListener=!0);class D{constructor(e,t,i,a,d,s,n){r("VideoAdRendering constructor"),this.videoAdManager_=e,this.videoPlayer_=t,this.isPlaylist=d,this.videoObject=s,this.customClickDiv_=document.getElementById("customClick"),this.contentCompleteCalled_=!1,this.isAdRequested=!1,this.isMuted=t.getPlayerMute(),this.isPlaying=!1,this.adUnit=i,this.adsInitializer=a,this.adsLoader_=a.adsLoader_,this.onResizeCallback=this.bind_(this,this.playerResizeHandler),this.adTrackingTimer=null,this.adsLoader_.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded_,!1,this),this.adsLoader_.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError_,!1,this),r("ads loader setup. adsLoader_:",this.adsLoader_),this.prerollQueued=!1,this.prerollAdsRequest=null,this.adsLoaded=!1,this.statSource=-1,this.started=!1,this.adPosterURL=this.createFakePoster(),this.setAutoplay(n),this.adsInitializer.isContainerInitialized()||this.waitForInitialUserInteraction()}async initialize(){return new Promise((e=>{e()}))}isOutstream(){return this.adUnit.toLowerCase().includes("outstream")}setAutoplay(e){let t=!1,i=!1;e&&(t=e.autoplay_allowed,i=e.autoplay_allowed_muted),this.autoplayAllowed=this.videoPlayer_.isPlayerAutoplay()&&t,this.autoplayRequiresMuted=this.videoPlayer_.isPlayerAutoplay()&&i}waitForInitialUserInteraction(){this.startEvent="click",(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(this.startEvent="touchend"),this.initAdDisplayContainer=function(){r("Initializing ad display container after user input"),this.adsInitializer.initializeContainer(),this.videoPlayer_.getVideoContainer().removeEventListener(this.startEvent,this.boundAdDisplayInit),this.adsLoaded&&(r("Starting ads manager"),this.startAdsManager_(this.adsManager_))},this.boundAdDisplayInit=this.initAdDisplayContainer.bind(this),this.videoPlayer_.getVideoContainer().addEventListener(this.startEvent,this.boundAdDisplayInit),r("Waiting for user input to initialize ad display container")}determineIfShouldPause(){return(!this.videoAdManager_||!this.videoAdManager_.isOutstream)&&(!this.isVpTest()&&this.pauseAfterStart?(r("video is currently paused. delaying video ads from playing"),this.pauseAfterStart=!1,this.videoAdManager_&&this.videoAdManager_.pauseAd(),!0):!this.videoPlayer_.getPlayerViewable()&&(r("video is not in viewport. delaying video ads from playing"),this.videoAdManager_&&this.videoAdManager_.pauseAd(),this.videoPlayer_.once(null,"videoOnScreen",(function(){this.videoAdManager_&&this.videoAdManager_.resumeAd()})),!0))}attachPlayerResizeEvent(e){e.on("playerresize",this.onResizeCallback)}playerResizeHandler(e){var t=this.videoPlayer_.getVideoDimensions();this.resize(t.width,t.height,!1)}bind_(e,t){return function(){t.apply(e,arguments)}}requestAds(e){if(this.isAdRequested)r("Ads are already requested!!!");else if(this.videoPlayer_.getVideoElement()){if(this.videoAdManager_&&!this.videoAdManager_.getCanShowMoreAds())return r("No more ads allowed to be shown"),this.videoAdManager_.setAllBreaksToTriggered(),void this.handleResetRenderer();r("requestAds to adsLoader"),this.isMuted=this.videoPlayer_.getPlayerMute(),this.isAdRequested=!0,this.contentCompleteCalled_=!1,this.allAdsCompleted_=!1,this.doImaAdRequest(e)}}doImaAdRequest(e){var t=new google.ima.AdsRequest;if(e.hasOwnProperty("vastXML"))t.adsResponse=e.vastXML;else{if(!e.vastURL)return void r("requestAds aborted: no vast provided");{const i=new URL(e.vastURL);i.searchParams.set("vpmute",this.isMuted?"1":"0");const a=document.cookie.split("; ").find((e=>e.startsWith("ezppid_ck=")))?.split("=")[1]||null;if(a&&i.searchParams.set("ppid",a),window.__ezOutstream?.UseGPTOutstream){const e=new URLSearchParams(i.searchParams.get("cust_params")||"");e.set("eb_br","zero"),i.searchParams.set("cust_params",e.toString())}t.adTagUrl=i.toString()}}var i=this.videoPlayer_.getVideoDimensions();t.linearAdSlotWidth=i.width,t.linearAdSlotHeight=i.height,t.nonLinearAdSlotWidth=i.width,t.nonLinearAdSlotHeight=150,t.vastLoadTimeout=7e3,t.pageUrl=window.location.href,"undefined"!=typeof vectx?t.pageUrl=vectx.parent_url:"undefined"!=typeof magicOutstreamCtx&&(t.pageUrl=magicOutstreamCtx.parent_url),t.contentTitle=this.videoObject.VideoTitle,t.contentDuration=this.videoPlayer_.getVideoLength(),t.setAdWillAutoPlay(this.autoplayAllowed),t.setAdWillPlayMuted(this.isMuted),"undefined"!==typeof __ezOutstream&&__ezOutstream.hasOwnProperty("adContinuousPlayback")&&this.adUnit.toLowerCase().includes("outstream")&&(2===__ezOutstream.adContinuousPlayback&&t.setContinuousPlayback(!0),1===__ezOutstream.adContinuousPlayback&&t.setContinuousPlayback(!1)),r("adsLoader",this.adsLoader_,"adsRequest",t),this.adsLoader_.requestAds(t)}waitForAdsManager(e){var t=this,i=setInterval((function(){t.adsManager_&&(clearInterval(i),e())}),1e3)}isAdPlaying(){return this.isPlaying}pause(){this.adsManager_&&(this.adsManager_.pause(),this.isPlaying=!1)}resume(){this.adsManager_&&(this.isVpTest()?this.started?this.adsManager_.resume():this.adsManager_.start():this.adsManager_.resume(),this.isPlaying=!0)}isAdMuted(){return this.isMuted}mute(){this.adsManager_&&(this.adsManager_.setVolume(0),this.isMuted=!0)}unmute(){this.adsManager_&&(this.adsManager_.setVolume(1),this.isMuted=!1)}setVolume(e){this.adsManager_&&this.adsManager_.setVolume(e),this.isMuted=0==e}resize(e,t,i){this.adsManager_&&(i?this.adsManager_.resize(e,t,google.ima.ViewMode.FULLSCREEN):this.adsManager_.resize(e,t,google.ima.ViewMode.NORMAL))}contentEnded(){this.contentCompleteCalled_=!0,this.adsManager_&&(this.adsManager_.destroy(),this.adsManager_=null),this.videoAdManager_.videoAdUi.hideUi(),this.adsLoader_.contentComplete()}onAdsManagerLoaded_(e){this.log("Ads manager loaded event");var t=new google.ima.AdsRenderingSettings;t.useStyledLinearAds=!1,t.useStyledNonLinearAds=!0,t.enablePreloading=!0,t.mimeTypes=["video/mp4","video/ogg"],t.loadVideoTimeout=15e3,this.adsManager_=e.getAdsManager(this.videoPlayer_.getVideoElement(),t),this.adsManager_.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError_,!1,this),this.adsManager_.addEventListener(google.ima.AdEvent.Type.LOG,this.onLogEvent_,!1,this),this.adsInitializer.adsManager_=this.adsManager_,this.adsLoaded=!0,this.adsInitializer.isContainerInitialized()&&(r("Ad display container initialized. Starting ads manager."),this.startAdsManager_(this.adsManager_))}startAdsManager_(e){e.isCustomClickTrackingUsed()&&(this.customClickDiv_.style.display="table"),this.events=[],e.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested_,!1,this),e.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested_,!1,this);var t=[google.ima.AdEvent.Type.AD_CAN_PLAY,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.LOG,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.DURATION_CHANGE];for(var i in t)e.addEventListener(t[i],(e=>this.events.push(e)),!1,this),e.addEventListener(t[i],this.onAdEvent_,!1,this);this.initAdManager(e),this.isVpTest()||(this.videoAdManager_.handleStartAd(),e.start())}initAdManager(e){if(this.videoPlayer_.isFullscreen())e.init(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN);else{var t=this.videoPlayer_.getVideoDimensions();"undefined"!==typeof magicOutstreamCtx&&(t={width:"100%",height:"100%"}),e.init(t.width,t.height,google.ima.ViewMode.NORMAL)}}onContentPauseRequested_(){r("onContentPauseRequested_"),this.videoAdManager_.pauseForAd(),this.videoAdManager_.setVideoEndedCallbackEnabled(!1)}onContentResumeRequested_(){this.videoAdManager_.setVideoEndedCallbackEnabled(!0),this.videoAdManager_.videoAdUi.hideUi(),this.videoAdManager_.resumeAfterAd(!0)}async onAdEvent_(e){this.log("Ad event",e,this.events.map((e=>e.type)));const t=window.ezVideoAdConductor?.getVideoAdConductor();switch(e.type){case google.ima.AdEvent.Type.AD_CAN_PLAY:"undefined"!==typeof ezOutstreamPlayer&&"ez-video-outstream"===this.videoPlayer_.player.player.id_&&(t?await t.startOutstream():ezOutstreamPlayer.RaisePlayer(),this.videoObject.IsMagicEmbed&&window.parent.postMessage({name:"showOutstream"},"*"));const i=document.getElementById(`ez-video-ad-container-${this.videoObject.PlayerId}`);if(i){const e=i.getElementsByTagName("video");Array.from(e).forEach((e=>{e.getAttribute("poster")||e.setAttribute("poster",this.adPosterURL)}))}this.isVpTest()&&(t&&(this.isOutstream()?await t.outstreamReadyToStart():await t.instreamReadyToStart()),this.videoPlayer_.paused()&&this.videoPlayer_.userPaused_||this.adsManager_.start());break;case google.ima.AdEvent.Type.STARTED:this.started=!0,this.isVpTest()&&(this.isPlaying=!0,this.videoAdManager_.handleStartAd());let a=this.determineIfShouldPause();this.currentAd=e.getAd(),this.log("Ad event getAd: ",e.getAd()),this.currentAd.isLinear()&&(this.adTrackingTimer=setInterval(this.onAdPlayTracker.bind(this),250),this.videoAdManager_.addTotalAdsPlaybackDuration_(this.currentAd.getDuration())),this.videoAdManager_.videoAdUi.onAdBreakStart(e),t&&!a&&(this.isOutstream()?t.handleOutstreamAdResumed():t.handleInstreamAdResumed()),!this.videoPlayer_.isCurrentlyFloating()||1!==this.videoPlayer_.videoObject.MagicPlaceholderType||2!==this.videoPlayer_.videoObject.MagicBehaviorVersion&&3!==this.videoPlayer_.videoObject.MagicBehaviorVersion||this.videoPlayer_.player.player.trigger("force-show-container");break;case google.ima.AdEvent.Type.CLICK:this.videoAdManager_.adClicked();break;case google.ima.AdEvent.Type.LOADED:this.isVpTest()||(this.isPlaying=!0,this.pauseAfterStart=this.videoPlayer_.paused()&&this.videoPlayer_.userPaused_),this.statSource=this.getStatSourceId(e);break;case google.ima.AdEvent.Type.LOG:let d=e.getAdData();d.adError&&console.log("Non-fatal error occurred: "+d.adError.getMessage());break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.isAdRequested=!1,this.isPlaying=!1,this.adsManager_&&(this.adsManager_.destroy(),this.adsManager_=null),this.adTrackingTimer&&clearInterval(this.adTrackingTimer),"undefined"!==typeof ezOutstreamPlayer&&"ez-video-outstream"===this.videoPlayer_.player.player.id_&&(ezOutstreamPlayer.LowerPlayer(),this.videoObject.IsMagicEmbed&&window.parent.postMessage({name:"hideOutstream"},"*"),ezOutstreamPlayer.CallNextAdBreak()),t&&(this.isOutstream()?t.handleOutstreamAdEnded():t.handleInstreamAdEnded()),this.videoAdManager_.videoAdUi.hideUi(),this.videoAdManager_.videoAdUi.onAdBreakEnd(),this.adsLoader_.contentComplete(),!this.videoPlayer_.isCurrentlyFloating()||1!==this.videoPlayer_.videoObject.MagicPlaceholderType||2!==this.videoPlayer_.videoObject.MagicBehaviorVersion&&3!==this.videoPlayer_.videoObject.MagicBehaviorVersion||this.videoPlayer_.player.player.trigger("force-hide-container");break;case google.ima.AdEvent.Type.PAUSED:this.videoAdManager_.videoAdUi.onAdsPaused();break;case google.ima.AdEvent.Type.RESUMED:this.videoAdManager_.videoAdUi.onAdsResumed(),t&&(this.isOutstream()?t.handleOutstreamAdResumed():t.handleInstreamAdResumed());break;case google.ima.AdEvent.Type.USER_CLOSE:e.getAd().isLinear()||(this.isAdRequested=!1,this.isPlaying=!1,this.videoAdManager_.videoAdUi.hideUi());break;case google.ima.AdEvent.Type.SKIPPED:this.videoAdManager_.subtractTotalAdsPlaybackDuration_(this.adsManager_.getRemainingTime());break;case google.ima.AdEvent.Type.DURATION_CHANGE:this.currentAd&&this.currentAd.isLinear()&&this.videoAdManager_.subtractTotalAdsPlaybackDuration_(this.currentAd.getDuration());const s=e.getAd();s&&s.isLinear()&&this.videoAdManager_.addTotalAdsPlaybackDuration_(s.getDuration())}}onAdPlayTracker(){if(null==this.adsManager_)return;const e=this.adsManager_.getRemainingTime(),t=this.currentAd.getDuration();let i=t-e;i=i>0?i:0;let a,d=0;this.currentAd.getAdPodInfo()&&(a=this.currentAd.getAdPodInfo().getAdPosition(),d=this.currentAd.getAdPodInfo().getTotalAds()),this.videoAdManager_.videoAdUi.updateAdUi(i,e,t,a,d)}onAdError_(e){let t=n(e.getError());r("Ad error: "+t),this.adsManager_&&(this.adsManager_.destroy(),this.adsManager_=null);let i=e.getError().getErrorCode();var a=!1;901==i&&(t.includes("303")&&(a=!0),t.includes("1005")&&this.blockPrevSSIDForPageview()),901!=i&&402!=i||a||(r("Restarting player after ad error"),this.videoPlayer_.play()),303==i||a||this.handleRemoveBidInformationFromVastUrl(),r("Attempting to retry google ad rendering"),this.retryAdFill(e)}retryAdFill(e){if(e){var t=this.videoAdManager_.currentAdBreak;if(t){var i=!1,a=n(e.getError()),d=e.getError().getErrorCode(),s=!1;if(901==d&&a.includes("303")&&(s=!0),1009===d||303===d||s?(r("retrying ad request",t),this.isAdRequested=!1,i=this.videoAdManager_.retryAdRequest(t)):(r("retryAdFill errorCode:",d,", description:",n(e.getError()),", adunit:",this.adUnit),1005===d&&t.retryCount<1&&(this.isAdRequested=!1,t.retryCount++,i=this.videoAdManager_.retryAdRequest(t))),!i&&this.videoPlayer_){this.videoPlayer_.attachAdAnalytics(this.adUnit,void 0,this.videoObject,!1).videoAdEventHandler.sendUnfilledVadPixel(t,n(e.getError())),__ez.vhb.biddingComplete(t.getPlayerId()),t.isOutstream&&"undefined"!==typeof ezOutstreamPlayer&&(r("ad not filled"),ezOutstreamPlayer.CallNextAdBreak()),r("finished retrying for ads"),this.handleResetRenderer()}}else r("Missing ad break for retry - skipping retry"),this.handleResetRenderer()}else r("Missing ad error event - skipping retry"),this.handleResetRenderer()}onLogEvent_(e){let t=e.getAdData();if(t.adError){r("Non-fatal error: "+n(t.adError)),n(t.adError).includes("1005")&&this.blockPrevSSIDForPageview();let e=this.videoAdManager_.currentAdBreak;if(this.videoPlayer_){this.videoPlayer_.attachAdAnalytics(this.adUnit,void 0,this.videoObject,!1).videoAdEventHandler.sendUnfilledVadPixel(e,n(t.adError))}}}handleResetRenderer(){r("resetting renderer"),this.videoAdManager_.videoAdUi.hideUi(),this.isAdRequested=!1,this.isPlaying=!1,this.videoAdManager_.resumeAfterAd(!1)}createFakePoster(){const e=document.createElement("canvas");e.width=1,e.height=1;return e.getContext("2d").clearRect(0,0,e.width,e.height),e.toDataURL("image/png")}blockPrevSSIDForPageview(){__ez&&__ez.vhb&&("undefined"===typeof __ez.vhb.blocked_ssids&&(__ez.vhb.blocked_ssids={}),-1!==this.statSource&&(__ez.vhb.blocked_ssids[this.statSource]=!0,r("blocked ssids: ",this.statSource,__ez.vhb.blocked_ssids)))}getStatSourceId(e){let t="";if(e.getAd&&"function"===typeof e.getAd){let i=e.getAd(),a=i.getWrapperAdSystems(),d=i.getWrapperAdIds(),s=a.findIndex((e=>"Ezoic"===e));s>=0&&d.length>s&&(t=d[s])}return t?"aps"===t?this.isOutstream?11337:11324:parseInt(t):-1}handleRemoveBidInformationFromVastUrl(){if("undefined"===typeof _ezaq||!_ezaq.hasOwnProperty("ab_test_id")||"mod154"!==_ezaq.ab_test_id)return;-1!==this.statSource&&(__ez.vhb.bidderErrorCount||(__ez.vhb.bidderErrorCount={}),__ez.vhb.bidderErrorCount[this.statSource]?__ez.vhb.bidderErrorCount[this.statSource]++:__ez.vhb.bidderErrorCount[this.statSource]=1,__ez.vhb.bidderErrorCount[this.statSource]>1&&(r("blocking stat source for pageview: ",this.statSource),this.blockPrevSSIDForPageview()));if(this.statSource>0&&![10077,35].includes(this.statSource)){r("removing header bidder params from vast url for stat source: ",this.statSource);let e=this.videoAdManager_.currentAdBreak;r("old vast url: ",e.vastURL);let t=11324===this.statSource||11337===this.statSource;e.vastURL=this.cleanVastUrl(e.vastURL,!t,t),r("new vast url: ",e.vastURL),this.videoAdManager_.currentAdBreak=e}}cleanVastUrl(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{const a=new URL(e),d=a.searchParams.get("cust_params");if(!d)return e;const s=decodeURIComponent(d).split("&"),r=s.filter((e=>{const[a]=e.split("=");return(!t||!a.startsWith("hb_"))&&(!i||!a.startsWith("amzn"))})).join("&");return a.searchParams.set("cust_params",r),a.toString()}catch(a){return console.error("Error cleaning VAST URL:",a),e}}log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r(`[${this.videoPlayer_?.player?.player?.player_id}]`,...t)}isVpTest(){return"true"===window.__ez?.tf?.vp_test}}class w{constructor(e){u(this,"player",null),u(this,"currentAd",null),u(this,"adContainerDiv",null),u(this,"controlsDiv",document.createElement("div")),u(this,"countdownDiv",document.createElement("div")),u(this,"seekBarDiv",document.createElement("div")),u(this,"progressDiv",document.createElement("div")),u(this,"playPauseDiv",document.createElement("div")),u(this,"muteDiv",document.createElement("div")),u(this,"sliderDiv",document.createElement("div")),u(this,"sliderLevelDiv",document.createElement("div")),u(this,"fullscreenDiv",document.createElement("div")),u(this,"countdownDiv",document.createElement("div")),u(this,"boundOnMouseUp",this.onMouseUp.bind(this)),u(this,"boundOnMouseMove",this.onMouseMove.bind(this)),this.player=e,this.adContainerDiv=e.getAdContainer(),this.adContainerDiv.className="ez-video-ad-container",this.adContainerDiv.style.position="absolute",this.adContainerDiv.style.top="0px",this.adContainerDiv.style.zIndex=5,this.createUi(),this.adContainerDiv.addEventListener("mouseenter",this.showAdControls.bind(this),!1),this.adContainerDiv.addEventListener("mouseleave",this.hideAdControls.bind(this),!1)}createUi(){this.controlsDiv.className="ez-vad-controls",this.controlsDiv.style.width="100%",this.countdownDiv.className="ez-vad-countdown",this.seekBarDiv.className="ez-vad-seek-bar",this.seekBarDiv.style.width="100%",this.progressDiv.className="ez-vad-progress",this.playPauseDiv.classList.add("ez-vad-play-pause","ez-vad-playing"),this.playPauseDiv.addEventListener("click",this.onPlayPauseClick.bind(this),!1),this.muteDiv.classList.add("ez-vad-mute","ez-vad-non-muted"),this.muteDiv.addEventListener("click",this.onMuteClick.bind(this),!1),s()&&(this.muteDiv.style.left="2em"),this.sliderDiv.className="ez-vad-slider",this.sliderDiv.addEventListener("mousedown",this.onVolumeSliderMouseDown.bind(this),!1),s()&&(this.sliderDiv.style.display="none"),this.sliderLevelDiv.className="ez-vad-slider-level",this.fullscreenDiv.classList.add("ez-vad-fullscreen","ez-vad-non-fullscreened"),this.fullscreenDiv.addEventListener("click",this.onFullscreenClick.bind(this),!1),this.adContainerDiv.appendChild(this.controlsDiv),this.controlsDiv.appendChild(this.countdownDiv),this.controlsDiv.appendChild(this.seekBarDiv),this.controlsDiv.appendChild(this.playPauseDiv),this.controlsDiv.appendChild(this.muteDiv),this.controlsDiv.appendChild(this.sliderDiv),this.controlsDiv.appendChild(this.fullscreenDiv),this.seekBarDiv.appendChild(this.progressDiv),this.sliderDiv.appendChild(this.sliderLevelDiv)}onPlayPauseClick(){this.player.adRenderer.togglePlayPause()}onMuteClick(){this.player.adRenderer.toggleMuteUnmute()}onFullscreenClick(){this.player.adRenderer.toggleFullscreen()}onAdsPaused(){this.playPauseDiv.classList.add("ez-vad-paused"),this.playPauseDiv.classList.remove("ez-vad-playing"),this.showAdControls()}onAdsResumed(){this.onAdsPlaying(),this.showAdControls()}onAdsPlaying(){this.playPauseDiv.classList.add("ez-vad-playing"),this.playPauseDiv.classList.remove("ez-vad-paused")}updateAdUi(e,t,i,a,d){const s=Math.floor(t/60);let r=Math.floor(t%60);r.toString().length<2&&(r="0"+r);let n=": ";d>1&&(n=" ("+a+" of "+d+"): "),this.countdownDiv.innerHTML="Advertisement"+n+s+":"+r;const o=100*(e/i);this.progressDiv.style.width=o+"%"}unmute(){this.muteDiv.classList.add("ez-vad-non-muted"),this.muteDiv.classList.remove("ez-vad-muted"),this.sliderLevelDiv.style.width=100*this.player.getPlayerVolume()+"%"}mute(){this.muteDiv.classList.add("ez-vad-muted"),this.muteDiv.classList.remove("ez-vad-non-muted"),this.sliderLevelDiv.style.width="0%"}onVolumeSliderMouseDown(){window.addEventListener("mouseup",this.boundOnMouseUp,!1),window.addEventListener("mousemove",this.boundOnMouseMove,!1)}onMouseMove(e){this.changeVolume(e)}onMouseUp(e){this.changeVolume(e),window.removeEventListener("mouseup",this.boundOnMouseUp),window.removeEventListener("mousemove",this.boundOnMouseMove)}changeVolume(e){let t=(e.clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth*100;t=Math.min(Math.max(t,0),100),this.sliderLevelDiv.style.width=t+"%",0==t?(this.muteDiv.classList.add("ez-vad-muted"),this.muteDiv.classList.remove("ez-vad-non-muted")):(this.muteDiv.classList.add("ez-vad-non-muted"),this.muteDiv.classList.remove("ez-vad-muted")),this.player.setPlayerVolume(t/100),this.player.adRenderer.ads_.setVolume(t/100)}showUi(){this.adContainerDiv.style.display="block"}hideUi(){this.adContainerDiv.style.display="none"}onAdContainerClick(){this.isAdNonlinear&&this.player.togglePlayPause()}reset(){this.hideUi()}onAdError(){this.hideUi()}onAdBreakStart(e){this.currentAd=e.getAd(),this.onPlayerVolumeChanged(this.player.getPlayerVolume()),this.showUi(),this.currentAd.isLinear()&&(this.controlsDiv.style.display="block",this.onAdsPlaying(),this.hideAdControls())}onAdBreakEnd(){(null==this.currentAd||this.currentAd.isLinear())&&this.hideUi(),this.controlsDiv.style.display="none",this.countdownDiv.innerHTML=""}onAllAdsCompleted(){this.hideUi()}onLinearAdStart(){this.adContainerDiv.classList.remove("ez-bumpable-ad-container"),this.isAdNonlinear=!1}onNonLinearAdLoad(){this.adContainerDiv.style.display="block",this.adContainerDiv.classList.add("bumpable-ima-ad-container"),this.isAdNonlinear=!0}onPlayerEnterFullscreen(){this.fullscreenDiv.classList.add("ez-vad-fullscreened"),this.fullscreenDiv.classList.remove("ez-vad-non-fullscreened")}onPlayerExitFullscreen(){this.fullscreenDiv.classList.add("ez-vad-non-fullscreened"),this.fullscreenDiv.classList.remove("ez-vad-fullscreened")}onPlayerVolumeChanged(e){0==e?(this.muteDiv.classList.add("ez-vad-muted"),this.muteDiv.classList.remove("ez-vad-non-muted"),this.sliderLevelDiv.style.width="0%"):(this.muteDiv.classList.add("ez-vad-non-muted"),this.muteDiv.classList.remove("ez-vad-muted"),this.sliderLevelDiv.style.width=100*e+"%")}showAdControls(){this.controlsDiv.classList.add("ez-vad-controls-showing")}hideAdControls(){this.controlsDiv.classList.remove("ez-vad-controls-showing")}}const E=class{constructor(e,t,i){this.videoPlayer=e,this.trackBreaks_=this.bind_(this,this.trackBreaks),this.videoPlayer.onTimeUpdate(this.trackBreaks_),this.filterAdBreaks(t),r("VideoAdtimer created. adBreaks:",e,t,"num ad breaks",this.adBreaks.length),this.setAdBreakSkipValue(),this.seekStart=null,this.previousTime=0,this.currentTime=0,this.isPrebidRenderer=i,this.onSeekHandle_=this.bind_(this,this.onSeekHandle),this.onSeekedHandle_=this.bind_(this,this.onSeekedHandle),this.videoPlayer.on(null,"seeking",this.onSeekHandle_),this.videoPlayer.on(null,"seeked",this.onSeekedHandle_),this.videoPlayer.videoObject.MagicPlaceholderType==k&&this.adBreaks.length>0&&(this.earlyBidListenerKey=window._hmx.topWindowBridge.addScrollListener(this.checkIfShouldTriggerEarlyBidding.bind(this))),this.maxUnfilledAdsMultiplier=1,"undefined"!==typeof _ezaq&&_ezaq.hasOwnProperty("ab_test_id")&&"mod231"===_ezaq.ab_test_id&&(this.maxUnfilledAdsMultiplier=2)}setAdBreakSkipValue(){for(let e=0;e<this.adBreaks.length;e++)this.adBreaks[e].IsSkipped=!1}onSeekHandle(){null===this.seekStart&&(this.seekStart=this.previousTime)}onSeekedHandle(){if(this.seekStart<this.currentTime&&(r("Handling seek start less than currentTime ",this.seekStart,this.currentTime,"num ad breaks",this.adBreaks.length),this.markBreaksAsSkipped(this.seekStart,this.currentTime)),this.seekStart>this.currentTime){r("Handling seek start greater than currentTime ",this.seekStart,this.currentTime,"num ad breaks",this.adBreaks.length);for(let e=0;e<this.adBreaks.length;e++){this.videoPlayer.getAdBreakTime(this.adBreaks[e])>this.currentTime&&(this.adBreaks[e].IsSkipped=!1)}}this.seekStart=null}checkIfShouldTriggerEarlyBidding(){window._hmx.topWindowBridge.getBoundingClientRectInTopWindow(this.videoPlayer.player.player.el()).top/window._hmx.topWindowBridge.getTopWindowInnerHeight()<1.3&&(window._hmx.topWindowBridge.removeScrollListener(this.earlyBidListenerKey),this.triggerEarlyBidding())}triggerEarlyBidding(){let e=this.adBreaks[0];e.isTriggered||(r("Scroll triggered early bidding"),e.isTriggered=!0,e.earlyBid=!0,__ez.vhb.bid(e,this.isPrebidRenderer))}deactivateBreaks(){this.videoPlayer.offTimeUpdate(this.trackBreaks_)}activateBreaks(){this.videoPlayer.onTimeUpdate(this.trackBreaks_)}markBreaksAsSkipped(e,t){let i=0;for(let a=0;a<this.adBreaks.length;a++){if("undefined"!==typeof this.adBreaks[a].isTriggered&&!0===this.adBreaks[a].isTriggered)continue;let d=this.videoPlayer.getAdBreakTime(this.adBreaks[a]);d<=t&&!1===this.adBreaks[a].isComplete&&d>=e&&(i=a,this.adBreaks[a].IsSkipped=!0)}this.adBreaks[i].IsSkipped=!1}bind_(e,t){return function(){t.apply(e,arguments)}}trackBreaks(){if(this.previousTime=this.currentTime,this.currentTime=this.videoPlayer.getCurrentVideoTime(),!this.shouldBid())return;let e=this.adBreaks;this.videoPlayer.isEmbedCurrentlyFloating()&&"undefined"!==typeof this.floatingAdBreaks&&this.floatingAdBreaks.length>0&&(e=this.floatingAdBreaks);let t=this.videoPlayer.getNextAdBreak(e),i=t.nextBreak,a=t.idx;window.lastVideoFloor&&(__ezInstream.useNewVideoStartingFloor?i.setStartingBidFloor(window.lastVideoFloor.instream):window.lastVideoFloor.instream>=0&&i.setFallbackPosition(3*window.lastVideoFloor.instream)),e&&e[a]&&this.markAdBreakAsTriggered(e[a]),__ezInstream.UnfilledCnt>=3*this.maxUnfilledAdsMultiplier?r("Hit max unfilled ad request limit - not requesting more ads"):__ez.vhb.bid(i,this.isPrebidRenderer)}shouldBid(){let e=this.adBreaks;this.videoPlayer.isEmbedCurrentlyFloating()&&"undefined"!==typeof this.floatingAdBreaks&&this.floatingAdBreaks.length>0&&(e=this.floatingAdBreaks);let t=this.videoPlayer.getNextAdBreak(e);if(void 0===t||void 0===t.nextBreak||void 0===t.idx)return!1;let i=t.nextBreak;if(i.isTriggered)return!1;if(__ez.vhb.getBiddingInProcess(this.videoPlayer.player.player.player_id))return!1;if(this.videoPlayer.paused())return!1;let a=this.videoPlayer.getAdBreakTime(i);if(void 0===a)return!1;let d=this.videoPlayer.getCurrentVideoTime();return void 0!==d&&!(a-d>=10&&"FrontLoad"!==i.positionGen)}filterAdBreaks(e){"undefined"!==typeof isSharedEmbed&&isSharedEmbed&&(this.floatingAdBreaks=e.filter((e=>e.key.includes("floatingembed")))),this.adBreaks=e.filter((e=>!e.key.includes("floatingembed")))}markAdBreakAsTriggered(e){e.isTriggered=!0,"undefined"!==typeof this.floatingAdBreaks&&this.floatingAdBreaks.length>0&&(this.adBreaks.forEach((t=>{t.key!==e.key&&t.timeOffset<=e.timeOffset&&(t.isTriggered=!0)})),this.floatingAdBreaks.forEach((t=>{t.key!==e.key&&t.timeOffsetSeconds<=e.timeOffsetSeconds&&(t.isTriggered=!0)})))}nextOutstreamBreak(){if(r("outstreamTimer - nextOutstreamBreak called"),"none"===document.getElementById("ez-video-outstream-wrap").style.display)return void r("in nextOutstreamBreak: outstream display is none - not bidding");let e=this.videoPlayer.player.player;e.play_outstream&&__ez.vhb.requestBreaks(e.player_id,e.ezVideoId,e.ads_enabled,e.video_position_id,0,!0,!0)}markAllBreaksAsTriggered(){for(let e=0;e<this.adBreaks.length;e++)this.adBreaks[e].isOutstream||(this.adBreaks[e].isTriggered=!0)}},k=1;class z{constructor(e,t,i,a,d,s,r){u(this,"currentAdBreak",null),this.videoPlayer_=e,this.playing_=!1,this.adsActive_=!1,this.adsDone_=!1,this.videoAdContainerElement=document.getElementById(a.videoAdContainerId),this.adUnit=t,this.adBreaks=i,this.handleRenderAdEvent_=this.bind_(this,this.handleRenderAdEvent),this.vadTimer=new E(this.videoPlayer_,this.adBreaks,!1),__ez.vhb.addListener("RenderAdBreak",this.handleRenderAdEvent_),this.isOutstream=!1,this.videoAdUi=new w(e),this.ads_=new D(this,this.videoPlayer_,t,a,d,s,r),this.totalAdsPlaybackDuration_=0,this.maxAdDuration=30,this.adBreaks.length>0&&this.adBreaks[0].params&&this.adBreaks[0].params.max&&(this.maxAdDuration=this.adBreaks[0].params.max/1e3),this.maxAdDurationPlaybackAllowed_=this.videoPlayer_.getVideoLength(),this.fullscreenChangeCallback_=this.bind_(this,this.onFullscreenChange_),this.videoPlayer_.on(null,"fullscreenchange",this.fullscreenChangeCallback_),this.videoEndedCallback_=this.bind_(this,this.onContentEnded_),this.setVideoEndedCallbackEnabled(!0),this.isCountingPlaylistPlaytime=!1,this.setIsCountingPlaylistDurations()}static get ZERO_BID_HASH(){return"zero"}async initialize(){return Promise.resolve()}requestAds(e){this.ads_.requestAds(e)}handleRenderAdEvent(e){if(0!=this.isMyAdBreak(e.AdBreak.key)&&!this._handleRenderAdEventMagicPlayer(e)){var t=e.AdBreak;this.currentAdBreak=t,"start"===this.currentAdBreak.timeOffset&&"NoFallback"===this.currentAdBreak.videoFallbackType&&(this.videoPlayer_.pause(),console.time("preroll_no_bid")),this.requestAds(t)}}_handleRenderAdEventMagicPlayer(e){if("undefined"===typeof ezVideoAdConductor)return r("ezVideoAdConductor is undefined"),!1;let t=ezVideoAdConductor.getVideoAdConductor();return this.videoPlayer_.videoObject.MagicPlaceholderType==k&&e.AdBreak.earlyBid?(r("Rendering early ad break"),!1):this.isOutstream&&("undefined"!==typeof ezOutstreamPlayer&&ezOutstreamPlayer.isPauseAds()||t.autoPlayInstreamPlayer&&t.autoPlayInstreamPlayer.isCurrentlyFloating()||t.autoPlayInstreamPlayer&&t.autoPlayInstreamPlayer.isAdInProgress()&&!t.autoPlayInstreamPlayer.isAdPaused())?(this.attachOutstreamPlayEvent(e),!0):void 0}attachFloatingEvent(e){r("attaching floating event since we're in content");let t=function(e){r("floating - requesting ad break"),this.handleRenderAdEvent(e)}.bind(this,e);this.videoPlayer_.once(null,"startedFloating",t)}attachOutstreamPlayEvent(e){if("undefined"===typeof ezVideoAdConductor)return;r("attaching outstream play event since it's paused");let t=ezVideoAdConductor.getVideoAdConductor(),i=function(e){this.handleRenderAdEvent(e),e&&e.detail&&e.detail.done&&e.detail.done()}.bind(this,e);t.addListenerOnce("startOutstream",i)}handleStartAd(){"start"===this.currentAdBreak.timeOffset&&"NoFallback"===this.currentAdBreak.videoFallbackType&&console.timeEnd("preroll_no_bid")}isMyAdBreak(e){let t=e.toLowerCase().includes("outstream");return this.isOutstream?t:!(!this.isOutstream&&t)&&this.adBreaks.filter((function(t){return t.key===e})).length>0}requestAllAds(e){this.adBreaks=e,this.vadTimer.deactivateBreaks(),this.vadTimer=new E(this.videoPlayer_,this.adBreaks,!1)}pauseAd(){this.ads_.pause(),this.videoAdUi.onAdsPaused()}resumeAd(){this.ads_.resume(),this.videoAdUi.onAdsResumed()}isAdPlaying(){return this.ads_.isAdPlaying()}togglePlayPause(){this.ads_.isAdPlaying()?(this.ads_.pause(),this.videoAdUi.onAdsPaused()):(this.ads_.resume(),this.videoAdUi.onAdsResumed())}toggleMuteUnmute(){this.ads_.isAdMuted()?(this.videoPlayer_.setPlayerVolume(1),this.ads_.unmute(),this.videoAdUi.unmute()):(this.videoPlayer_.setPlayerVolume(0),this.ads_.mute(),this.videoAdUi.mute())}toggleFullscreen(){this.videoPlayer_.toggleFullscreen()}setTimeUpdateCallbackEnabled(e){}setVideoEndedCallbackEnabled(e){e?this.videoPlayer_.registerVideoEndedCallback(this.videoEndedCallback_):this.videoPlayer_.removeVideoEndedCallback(this.videoEndedCallback_)}resumeAfterAd(e){e&&(this.videoPlayer_.ended()&&!this.isPlaylist||this.videoPlayer_.play()),this.adsActive_=!1;let t=this.videoPlayer_.getVideoContainer().getElementsByClassName("vjs-control-bar");t&&t.length>0&&(t[0].style=null),this.videoPlayer_.trigger("resume-after-ad")}pauseForAd(){this.adsActive_=!0,this.playing_=!0,this.videoPlayer_.pause();let e=this.videoPlayer_.getVideoContainer().getElementsByClassName("vjs-control-bar");e&&e.length>0&&(e[0].style.opacity=0),this.videoPlayer_.trigger("pause-for-ad")}adClicked(){}bind_(e,t){return function(){t.apply(e,arguments)}}onSampleAdTagClick_(){this.adTagBox_.value=this.adTagUrl_}onClick_(){if(!this.adsDone_)return this.ads_.initialUserAction(),this.videoPlayer_.preloadContent(this.bind_(this,this.loadAds_)),void(this.adsDone_=!0);this.adsActive_?this.playing_?this.ads_.pause():this.ads_.resume():this.playing_,this.playing_=!this.playing_,this.updateChrome_()}loadAds_(){this.videoPlayer_.removePreloadListener()}onFullscreenChange_(){if(this.videoPlayer_.isFullscreen()){var e=this.videoPlayer_.getVideoDimensions();this.ads_.resize(e.width,e.height,!0),this.videoAdUi.onPlayerEnterFullscreen()}else this.ads_.resize(window.screen.width,window.screen.height,!1),this.videoAdUi.onPlayerExitFullscreen()}onContentEnded_(){this.ads_.contentEnded(),__ez.vhb.biddingComplete(this.videoPlayer_.player.player.player_id),this.isCountingPlaylistPlaytime||this.setTotalAdsPlaybackDuration_(0)}retryAdRequest(e){var t=e.bidRetries,i=z.ZERO_BID_HASH,a=0;let d=e.getPlayerId();if(e.bidFloorIndex>=t||"frontload"===e.videoFallbackType)return!1;var s;e.bidFloorIndex<t&&(i=(s=this.getNextBid_(e)).hash,a=s.bidValue,r(`[${d}] Using fallback floor ${e.bidFloorIndex}\nbid floor: ${a}\n${e.isOutstream?"outstream":"instream"}\n`),"undefined"!==typeof googletag.companionAds&&"undefined"!==typeof window.ezVideo&&e.bidFloorIndex==t-1&&(googletag.companionAds().setRefreshUnfilledSlots(!0),window.ezVideo.stopCompanionRefresh=!1)),e.bidFloorIndex++,e.retryCount++;try{e=this.updateBidHash_(e,i)}catch(n){return console.error(n.message),!1}return e.videoAdBidFloor=a,e.origVastURL=e.vastURL,e.addBidsToVAST(),r("Retry request:",e.retryCount,"\nbid floor:",e.videoAdBidFloor,"\nbid hash:",e.lastBidHash,"\nprebid:",e.maxHBBidder,"\naps:",e.apsBid),this.ads_.requestAds(e),!0}getNextBid_(e){let t=e.videoFallbackFloors[e.bidFloorIndex];return void 0===e.videoFallbackHashes||e.bidFloorIndex>=e.videoFallbackHashes.length?{hash:z.ZERO_BID_HASH,bidValue:0}:{hash:e.videoFallbackHashes[e.bidFloorIndex],bidValue:t}}getNextBidBelow_(e,t){for(let i=0;i<e.videoFallbackFloors.length;i++)if(e.videoFallbackFloors[i]<t)return e.bidFloorIndex=i-1,{hash:e.videoFallbackHashes[i],bidValue:e.videoFallbackFloors[i]};return{hash:z.ZERO_BID_HASH,bidValue:0}}updateBidHash_(e,t){e.lastBidHash.includes(",")&&(e.lastBidHash=encodeURIComponent(e.lastBidHash)),t.includes(",")&&(t=encodeURIComponent(t));let i=e.vastURL.replace(/(eb_br%3D)[^%&]+/,`$1${t}`);if(e.lastBidHash!==t&&i===e.vastURL){throw new Error(`failed to replace old bid hash (${e.lastBidHash}) with new hash (${t}) in VAST ${e.vastURL}`)}return e.vastURL=i,e.lastBidHash=t,e}changeBidType_(e,t){if(e.bidFloorType===t)return e;let i=e.bidFloorType;e.bidFloorType=t;let a=e.vastURL.split("cust_params=");if(2===a.length){let d=a[1].split("ft%3D");if(2===d.length){let s=t.toString()+d[1].substring(i.toString().length),r=d[0]+"ft%3D"+s;e.vastURL=a[0]+"cust_params="+r}}return e}enableOutstream(){this.isOutstream=!0}setTotalAdsPlaybackDuration_(e){this.totalAdsPlaybackDuration_=e}addTotalAdsPlaybackDuration_(e){this.totalAdsPlaybackDuration_+=e}subtractTotalAdsPlaybackDuration_(e){this.totalAdsPlaybackDuration_-=e}getTotalAdsPlaybackDuration(){return this.totalAdsPlaybackDuration_}getCanShowMoreAds(){return!!this.isOutstream||(r("totalAdsPlaybackDuration_ + maxAdDuration < videoPlayer_.getVideoLength()",this.totalAdsPlaybackDuration_+this.maxAdDuration,this.videoPlayer_.getVideoLength(),this.maxAdDurationPlaybackAllowed_,this.isCountingPlaylistPlaytime),this.isCountingPlaylistPlaytime?this.totalAdsPlaybackDuration_+this.maxAdDuration<this.maxAdDurationPlaybackAllowed_:this.totalAdsPlaybackDuration_+this.maxAdDuration<this.videoPlayer_.getVideoLength())}setAllBreaksToTriggered(){this.vadTimer.markAllBreaksAsTriggered()}setIsCountingPlaylistDurations(){"undefined"!==typeof __ezInstream&&__ezInstream.playlistDurations&&__ezInstream.playlistDurations[this.videoPlayer_.player.player.player_id]&&(this.maxAdDurationPlaybackAllowed_=__ezInstream.playlistDurations[this.videoPlayer_.player.player.player_id],this.maxAdDurationPlaybackAllowed_&&(this.isCountingPlaylistPlaytime=!0))}getCurrentAdProgress(){if(!this.ads_||!this.ads_.adsManager_||!this.ads_.currentAd)return 0;let e=this.ads_.adsManager_.getRemainingTime(),t=this.ads_.currentAd.getDuration()-e;return t=t>0?t:0,t}}class C{constructor(e){e&&"undefined"!==typeof __ezOutstream?this.__ezPixelObj=__ez.osvaep:this.__ezPixelObj=__ez.vaep}addCounts(e){var t=e.uuid;e.play_cnt>0&&this.__ezPixelObj.Add(t,[new __ezDotData("play_cnt",e.play_cnt)],e),e.pause_cnt>0&&this.__ezPixelObj.Add(t,[new __ezDotData("pause_cnt",e.pause_cnt)],e)}addMediaSrc(e,t,i){this.__ezPixelObj.Add(e,[new __ezDotData("ad_src",t)],i)}addSystem(e,t,i){this.__ezPixelObj.Add(e,[new __ezDotData("ad_system",t)],i)}addClient(e,t,i){this.__ezPixelObj.Add(e,[new __ezDotData("ad_client",t)],i)}addStart(e,t,i){var a=(new Date).toLocaleString("sv",{timeZone:"America/Chicago"});this.__ezPixelObj.Add(e,[new __ezDotData("ad_start",a),new __ezDotData("offset_ad_start",t)],i)}addCompleted(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("completed",1)],t)}addErrored(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("errored",1)],t)}addSkipped(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("skipped",1)],t)}addClicked(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("clicked",1)],t)}addViewed(e,t,i,a){i=i?1:0,this.__ezPixelObj.Add(e,[new __ezDotData("viewed_"+t,i)],a)}addHeard(e,t,i,a){i=i?1:0,this.__ezPixelObj.Add(e,[new __ezDotData("heard_"+t,i)],a)}addViewable(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("viewable",1)],t)}addAdBounce(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("ad_bounce",1)],t)}addPodData(e,t,i){this.__ezPixelObj.Add(e,[new __ezDotData("total_ads",t.total_ads),new __ezDotData("ad_length",i)],t)}addAdClosed(e,t){this.__ezPixelObj.Add(e,[new __ezDotData("closed",1)],t)}fire(){this.__ezPixelObj.Fire()}}const S=11324,x=11337;class T{constructor(e,t,a){let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;this.isOutstream=t.toLowerCase().includes("outstream"),this.currentAdBreak=e.adRenderer.currentAdBreak,this.adPixels=new C(this.isOutstream),this.isPrebidRenderer=s,_ezaq.hasOwnProperty(["visit_uuid"])?this.visit_uuid=_ezaq.visit_uuid:this.visit_uuid=i("ezovuuid_"+_ezaq.domain_id),this.vadStoreURL=this.isOutstream?"/porpoiseant/osvad.gif":"/porpoiseant/vad.gif",this.player=e,this.adUnit=t,this.videoContentShare=d,this.paused=!1,this.firstViewable=null,this.videoObject=a,this.adData={},this.adPodVaID="",this.cumulativeAdLength=0,this.unloadAllCallback=this.bind_(this,this.unloadAll),this.adBounceCallback=this.bind_(this,this.handleAdBounce),this.firedImps={},this.isOutstream&&this.bind_(this,this.attachOutstreamPlayerEvent)(),ez_attachEvent(document,"blur",this.unloadAllCallback),ez_attachEvent(window,"beforeunload",this.unloadAllCallback),ez_attachEvent(window,"blur",this.unloadAllCallback),ez_attachEvent(window,"pagehide",this.unloadAllCallback),ez_attachEvent(window,"unload",this.unloadAllCallback)}bind_(e,t){return function(){t.apply(e,arguments)}}initAdImpression(){r("Getting ad data for player"),this.adData.url=_ezaq.url,this.adData.pageview_id=_ezaq.page_view_id,_ezaq.hasOwnProperty(["visit_uuid"])?this.adData.visit_uuid=_ezaq.visit_uuid:this.adData.visit_uuid=i("ezovuuid_"+_ezaq.domain_id),this.adData.template_id=_ezaq.template_id,this.adData.domain_id=_ezaq.domain_id,this.adData.ab_test_id=_ezaq.ab_test_id,this.adData.vab_test_id=_ezaq.ab_test_id,""===this.adPodVaID?this.adData.video_ad_impression_id=this.generateUUID():this.adData.video_ad_impression_id=this.adPodVaID,this.generateInitAdData(this.adData.video_ad_impression_id),this.adData.ad_position="start",this.player.analytics&&!this.isOutstream&&(this.adData.video_impression_id=this.player.analytics.getVideoImpressionUUID()),this.adData.ad_client="Google IMA",this.isPrebidRenderer&&(this.adData.ad_client="Prebid Player"),this.adData.ad_system="Google Ad Manager",this.adData.ad_index=1,this.currentAdBreak.isOutstream&&("undefined"===typeof ezVideoAdConductor&&"undefined"===typeof magicOutstreamCtx||(this.adData.is_universal=!0),this.adData.ad_index=__ezOutstream.AdIndex,__ezOutstream.AdIndex+=1),this.videoContentShare&&Object.keys(this.videoContentShare).length>0&&d(this.videoContentShare)&&(this.adData.owner_domain_id=this.videoContentShare.DomainIdOwner),this.adData.humix_channel_id=this.videoObject.HumixChannelId,this.adData.player_name=this.player.playerDef,this.currentAdBreak.isOutstream?(this.adData.is_outstream=!0,this.adData.float_pos=this.currentAdBreak.floatPosition,"undefined"!==typeof window.ezslot_outstream&&"undefined"!==typeof __ezOutstream&&__ezOutstream.fallbackToGPT&&(this.adData.is_gpt_outstream=!0)):this.adData.is_outstream=!1,this.adData.cnx_backfill=this.currentAdBreak.cnx_backfill,this.adData.no_retry="undefined"!==typeof __ezOutstream&&__ezOutstream.rampUp||"undefined"!==typeof __ezInstream&&__ezInstream.rampUp?1:0}generateInitAdData(e){this.adData.uuid=e,this.adData.play_cnt=0,this.adData.pause_cnt=0,this.adData.completed=!1,this.adData.errored=!1,this.adData.skipped=!1,this.adData.clicked=!1,this.adData.viewable=!1}generateUUID(){var e=(new Date).getTime();return e+=performance.now(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}unloadAll(){this.adPixels.addCounts(this.adData),this.adPixels.fire()}handleQuartileEvent(e){let t;switch(e.type){case"firstQuartile":t="first_quartile";break;case"midpoint":t="middle";break;case"thirdQuartile":t="third_quartile";break;default:return void r("Could not find quartile for type =",e.type)}let i=this.player.getPlayerViewable()?1:0,a=(this.player.getPlayerVolume(this)>=10&&this.player.getPlayerMute(this),this.adData.uuid);this.adPixels.addViewed(a,t,i)}determineWinningAdIdFromEvent(e){let t="";if(e.getAd&&"function"===typeof e.getAd){let i=e.getAd(),a=i.getWrapperAdSystems(),d=i.getWrapperAdIds(),s=a.findIndex((e=>"Ezoic"===e));s>=0&&d.length>s?(t=d[s],r("winning ad id: "+t)):"function"===typeof i.getAdId&&(t=i.getAdId())}return t}async handleInitialTime(e){if(this.isPrebidRenderer&&this.currentAdBreak&&this.currentAdBreak.impressionId&&this.firedImps[this.currentAdBreak.impressionId])return;r("handleInitialTime",this.isPrebidRenderer,this.currentAdBreak,this.currentAdBreak.impressionId,this.firedImps[this.currentAdBreak.impressionId]),this.firedImps[this.currentAdBreak.impressionId]=!0;let t=this.determineWinningAdIdFromEvent(e);this.currentAdBreak&&"function"===typeof this.currentAdBreak.handleWinningAdIdOrHbUUId?this.currentAdBreak.handleWinningAdIdOrHbUUId(t):"function"===typeof this.currentAdBreak.removeCachedBidsFromAdBreak&&this.currentAdBreak.removeCachedBidsFromAdBreak(),this.adData={ad_filled:1},!0===this.isOutstream&&"undefined"!==typeof __ezOutstream?__ezOutstream.UnfilledCnt=0:__ezInstream.UnfilledCnt=0,this.adSystem="",this.initAdImpression(),"function"===typeof e.getAd&&("function"===typeof e.getAd().getDuration&&(this.adData.ad_length=Math.round(e.getAd().getDuration())||0,this.cumulativeAdLength+=this.adData.ad_length),"function"===typeof e.getAd().getAdSystem&&(this.adSystem=e.getAd().getAdSystem(),this.adData.ad_system=this.adSystem,r("Ad Source (Advertiser name): "+this.adSystem)));let i=1;if(this.currentAdBreak&&e&&"function"===typeof e.getAd){let t=e.getAd(),a=t.getAdPodInfo();if(i=a.getTotalAds(),this.adData.total_ads=a.getAdPosition(),i>1&&1===this.adData.total_ads?(r("AdPods loaded, total_ads:  "+i+"."),this.adPodVaID=this.adData.uuid):1===i&&(this.adPodVaID=""),!this.isPrebidRenderer&&"undefined"!==typeof google&&google.ima&&google.ima.CompanionAdSelectionSettings){let e=new google.ima.CompanionAdSelectionSettings;e.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType.STATIC,e.creativeType=google.ima.CompanionAdSelectionSettings.CreativeType.IMAGE,e.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;let i=t.getCompanionAds(300,250,e);this.adData.has_companion=i.length>0?1:0}else this.adData.has_companion=0;if(this.currentAdBreak.impressionId=this.currentAdBreak.impressionId,i>1&&this.adData.total_ads>1)this.adPixels.addPodData(this.adData.uuid,this.adData,this.cumulativeAdLength);else{this.handleAdBreakData(this.currentAdBreak);let e=this.videoObject.IsSharedEmbed||this.videoObject.IsMagicEmbed;this.handleAdImpressionData(e)}}let a=this.adData.uuid,d=this.player.getPlayerViewable()?1:0;this.adPixels.addStart(a,this.player.getCurrentVideoTime(),this.adData),this.adPixels.addViewed(a,"start",d),ez_attachEvent(window,"visibilitychange",this.adBounceCallback)}handlePlayEvent(e){r("Play event triggered for ad "+this.adData.uuid+"."),this.paused=!1,this.adData.play_cnt++}handlePauseEvent(e){r("Pause event triggered for ad "+this.adData.uuid+"."),this.paused=!0,this.firstViewable=null,this.adData.pause_cnt++}handleCompleteEvent(e){if(r("Complete event triggered for ad "+this.adData.uuid+"."),__ez.vhb.biddingComplete(this.videoObject.PlayerId),this.adData.completed)return void r("Complete event has already completed.");var t=this.adData.uuid;let i=this.player.getPlayerViewable()?1:0;this.adData.completed=!0,this.adPixels.addCompleted(t,this.adData),this.adPixels.addViewed(t,"end",i),this.unloadAll(),ez_detachEvent(document,"blur",this.unloadAllCallback),ez_detachEvent(window,"beforeunload",this.unloadAllCallback),ez_detachEvent(window,"blur",this.unloadAllCallback),ez_detachEvent(window,"pagehide",this.unloadAllCallback),ez_detachEvent(window,"unload",this.unloadAllCallback),ez_detachEvent(window,"beforeunload",this.adBounceCallback)}handleSkipEvent(e){if(__ez.vhb.biddingComplete(this.videoObject.PlayerId),r("Skip event triggered for ad "+this.adData.uuid+"."),this.adData.completed)return;let t=document.getElementById("adContainer");t&&(t.style.display="none"),this.adData.completed=!0,this.adPixels.addSkipped(this.adData.uuid,this.adData)}handleClickEvent(e){r("Click event triggered for ad "+this.adData.uuid+"."),this.adData.completed||(this.adData.completed=!0,this.adPixels.addClicked(this.adData.uuid,this.adData))}handleLogEvent(e){if("function"===typeof e.getAdData){let t=e.getAdData();if(t.adError){let e=t.adError;r("adError Type: "+e.getType()),r("adError: ",e),this.adData.uuid&&!this.adData.errored&&(this.adData.errored=!0,this.adPixels.addErrored(this.adData.uuid,this.adData))}}}handleAdProgressEvent(e){if(this.adData.viewable||!this.player.getPlayerViewable()||this.paused)this.firstViewable=null;else if(this.firstViewable){new Date-this.firstViewable>2e3&&(this.adData.viewable=!0,this.adPixels.addViewable(this.adData.uuid,this.adData))}else this.firstViewable=new Date}handleAdBreakData(e){this.adData.impression_id=e.impressionId,this.adData.ad_position=e.timeOffset,this.adData.ad_unit=this.adUnit,this.adData.ad_src=e.vastURL,this.adData.param_gen=e.paramGen,this.adData.position_gen=e.positionGen,this.adData.vad_type=e.breakType,this.adData.skippable=e.params&&e.params.skip,"undefined"!==typeof e.params&&(this.adData.min_ad_length=e.params.min,this.adData.max_ad_length=e.params.max,this.adData.ad_type=e.params.ad_type,this.adData.allowed_ad_sizes=e.params.ad_sizes),this.adData.t_pageview_epoch=_ezaq.t_epoch,this.adData.stat_source_id=e.statSourceId,this.adData.initial_stat_source_id=e.statSourceId,this.adData.bidders=`[${e.bidders}]`,this.adData.received_bidders=`[${e.receivedBidders}]`,this.adData.prebid_cpm=e.prebidCPM,void 0!==this.player.player.player.video_position_id&&(this.adData.video_position_id=this.player.player.player.video_position_id),this.adData.auction_retry_count=e.retryCount,this.adData.fallback_type=e.videoFallbackType,this.adData.bid_floor_gen=e.bidFloorGen,this.adData.multiplier=e.multiplier,this.adData.unmodified_cpm=e.videoAdBidFloorUnmodified,this.adData.unmodified_cpm_mean_abs_dev=e.videoAdBidFloorCPMMeanAbsDev,this.adData.cpm_query_type=e.queryType,this.adData.unmodified_cpm_std=e.videoAdBidFloorCPMStd,this.adData.unmodified_cpm_impression_cnt=e.videoAdBidFloorImpressions,this.adData.position_config=e.positionConfig,this.adData.floor_perturbance_size=e.videoAdBidFloorPerturbanceSize,this.adData.ad_filled&&(this.adData.winning_bid_floor=e.videoAdBidFloor),e&&e.statSourceId&&[S,x].includes(e.statSourceId)&&e.apsBid&&e.apsBid.bidVal&&(this.adData.aps_cpm=e.apsBid.bidVal),void 0===window.lastVideoFloor?window.lastVideoFloor={instream:-1,outstream:-1,last:e.videoAdBidFloor,highest:e.videoAdBidFloor}:window.lastVideoFloor.last=e.videoAdBidFloor,e.videoAdBidFloor>window.lastVideoFloor.highest&&(window.lastVideoFloor.highest=e.videoAdBidFloor),e.isOutstream?(window.lastVideoFloor.outstream=e.videoAdBidFloor,this.adData.ad_filled&&(11337===e.statSourceId&&e.apsBid?window.lastVideoFloor.outstream=e.apsBid.bidVal:"number"===typeof e.prebidCPM&&e.prebidCPM>=0&&(window.lastVideoFloor.outstream=e.prebidCPM))):window.lastVideoFloor.instream=e.videoAdBidFloor,this.adData.max_hb_bid=e.maxHBBid,this.adData.bid_floor_type=e.bidFloorType,void 0!==this.player.player.player.video_position_id&&(this.adData.is_floating=this.player.player.player.is_floating?1:0),this.adData.no_retry="undefined"!==typeof __ezOutstream&&__ezOutstream.rampUp||"undefined"!==typeof __ezInstream&&__ezInstream.rampUp?1:0,this.adData.initial_bid_floor=e.initialBidFloor,this.adData.winning_bid_hash=e.lastBidHash;let t="undefined"!==typeof ezdcr?ezdcr:"USD";this.adData.dfp_currency=t;let i="undefined"!==typeof ezacr?ezacr:"USD";this.adData.adx_currency=i}bidFloorToRealValue(e){return e/=1e3,isNaN(e)&&(e=0),e<=0&&(e=2e-6),e}handleAdImpressionData(e){r("Sending vad.gif");let t=this;var i=__ez.dot.getURL(this.vadStoreURL);if(__ez.dot.Fire(i,this.adData),"undefined"===typeof __ez||"undefined"===typeof __ez.pel)return;let a=t.bidFloorToRealValue(t.adData.winning_bid_floor),d=a;if("undefined"!==typeof t.adData.stat_source_id){let e=[new __ezDotData("stat_source_id",t.adData.stat_source_id)];t.adData.stat_source_id!==S&&t.adData.stat_source_id!==x&&(d=t.adData.prebid_cpm/1e3),__ez.pel.AddById(t.adData.ad_unit+"//"+t.adData.impression_id,e,__ez.template.isOrig,d,a),r("Stat source id pixel: "+t.adData.ad_unit+"//"+t.adData.impression_id+", stat_source_id = "+t.adData.stat_source_id+", rev = "+d)}let s=[new __ezDotData("loaded",1),new __ezDotData("viewed",1)];if(__ez.pel.AddById(t.adData.ad_unit+"//"+t.adData.impression_id,s,__ez.template.isOrig,d,a),r("Loaded pixel: "+t.adData.ad_unit+"//"+t.adData.impression_id+", rev = "+d+", bidFloorFilled = "+a),e){let e=new CustomEvent("reportPageviewAnalytics",{detail:{pageviewId:t.adData.pageview_id,dotName:"est_revenue_usd",dotData:d}});dispatchEvent(e)}else __ez.bit.Add(t.adData.pageview_id,[new __ezDotData("est_revenue_usd",d)])}handleAdBounce(){this.player&&this.player&&this.player.adRenderer&&this.player.adRenderer.adsActive_&&(r("Ad bounce"),this.adPixels.addAdBounce(this.adData.uuid,this.adData))}sendUnfilledVadPixel(e,t){r("UnfilledVadPixel"),this.adData={ad_filled:0,error_message:t};var i=[1005],a=[303,302,1009];let d=!1,s=this.extractAdErrorCodes(t),n=!1,o=this.isOutstream?__ezOutstream:__ezInstream;o&&o.hasOwnProperty("SelectivelyIncrementUnfilledCount")&&o.SelectivelyIncrementUnfilledCount&&(n=!0),d=n?s.some((e=>a.includes(e))):!s.some((e=>i.includes(e))),d&&(!0===this.isOutstream&&"undefined"!==typeof __ezOutstream?__ezOutstream.UnfilledCnt++:__ezInstream.UnfilledCnt++),e.impressionId=this.currentAdBreak.impressionId,this.initAdImpression(),this.handleAdBreakData(e);var l=__ez.dot.getURL(this.vadStoreURL);__ez.dot.Fire(l,this.adData)}extractAdErrorCodes(e){if(!e)return[];for(var t,i=/AdError\s+(\d+)/g,a=[];null!==(t=i.exec(e));)a.push(parseInt(t[1],10));return a}attachOutstreamPlayerEvent(){this.player.getEventEmitter().one("ezoPlayerClosed",(e=>{this.adData.closed=!0,this.adPixels.addAdClosed(this.adData.uuid,this.adData)}))}}class I{constructor(e,t,i,a){let d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;this.videoPlayer_=e,this.videoAdEventHandler=new T(e,t,a,d,s),this.adsManager_=i,this.isReady=!1,this.isPrebidRenderer=s,this.prebidBoundHandlers={},this.isPrebidRenderer&&(this.boundHandlers={handleInitialTime:this.videoAdEventHandler.handleInitialTime.bind(this.videoAdEventHandler),handleCompleteEvent:this.videoAdEventHandler.handleCompleteEvent.bind(this.videoAdEventHandler),handleSkipEvent:this.videoAdEventHandler.handleSkipEvent.bind(this.videoAdEventHandler),handleLogEvent:this.videoAdEventHandler.handleLogEvent.bind(this.videoAdEventHandler),handleAdProgressEvent:this.videoAdEventHandler.handleAdProgressEvent.bind(this.videoAdEventHandler),handleQuartileEvent:this.videoAdEventHandler.handleQuartileEvent.bind(this.videoAdEventHandler),handlePauseEvent:this.videoAdEventHandler.handlePauseEvent.bind(this.videoAdEventHandler),handlePlayEvent:this.videoAdEventHandler.handlePlayEvent.bind(this.videoAdEventHandler),handleClickEvent:this.videoAdEventHandler.handleClickEvent.bind(this.videoAdEventHandler)}),this.isPrebidRenderer?this.registerPrebidEventHandlers():this.registerAdEventHandlers()}bindHandler(e){if(!this.isPrebidRenderer)return null;if(!this.prebidBoundHandlers[e]){const t={adStarted:"handleInitialTime",adComplete:"handleCompleteEvent",adSkipped:"handleSkipEvent",adError:"handleLogEvent",adProgress:"handleAdProgressEvent",adQuartile:"handleQuartileEvent",adPaused:"handlePauseEvent",adResumed:"handlePlayEvent",adClick:"handleClickEvent"}[e];if(!t||!this.boundHandlers[t])return console.warn(`No handler found for event: ${e}`),()=>{};this.prebidBoundHandlers[e]=this.boundHandlers[t]}return this.prebidBoundHandlers[e]}registerPrebidEventHandlers(){if(!this.adsManager_)return;let e=this.adsManager_.adEventHandler;["adStarted","adComplete","adSkipped","adError","adProgress","adQuartile","adPaused","adResumed","adClick"].forEach((t=>{const i=this.bindHandler(t);i&&e.on(t,i)})),this.isReady=!0}registerAdEventHandlers(){this.adsManager_&&(this.adsManager_.addEventListener(google.ima.AdEvent.Type.AD_PROGRESS,this.videoAdEventHandler.handleAdProgressEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.CLICK,this.videoAdEventHandler.handleClickEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.videoAdEventHandler.handleCompleteEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,this.videoAdEventHandler.handleQuartileEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.LOG,this.videoAdEventHandler.handleLogEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.MIDPOINT,this.videoAdEventHandler.handleQuartileEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.PAUSED,this.videoAdEventHandler.handlePauseEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.RESUMED,this.videoAdEventHandler.handlePlayEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.videoAdEventHandler.handleSkipEvent,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.STARTED,this.videoAdEventHandler.handleInitialTime,!1,this.videoAdEventHandler),this.adsManager_.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,this.videoAdEventHandler.handleQuartileEvent,!1,this.videoAdEventHandler))}removePrebidEventHandlers(){if(!this.adsManager_||!this.isPrebidRenderer)return;let e=this.adsManager_.adEventHandler;Object.entries(this.prebidBoundHandlers).forEach((t=>{let[i,a]=t;e.off(i,a)})),this.isReady=!1,this.prebidBoundHandlers={}}destroy(){this.isPrebidRenderer&&(this.removePrebidEventHandlers(),this.boundHandlers={}),this.videoAdEventHandler=null}}class L{constructor(e){this.vData=e}handleInitialPlay(){var e=this.videoData,t=e.uuid;if(!(this.videoData.play_cnt>0)){M("Initial play event triggered");var i=0|this.player.getVideoLength();this.generateQuartileData(e,i),this.videoPixels.addStart(t),this.startDate=Date.now(),this.lastPosition=this.player.getCurrentVideoTime(),this.lastPositionSincePlayTimeRecorded=this.lastPosition}}handleLoadStart(){this.clearBufferingData()}handlePlayEvent(){M("Play event triggered for player "+this.id+"."),this.videoData.play_cnt++;let e=this.player.player.player;if(e.muted()||0===e.volume()||(this.videoData.lastUnmuted=new Date),this.isSeeking){let e=this.player.getCurrentVideoTime()-this.initialSeekTime>0;this.isScrubbing?e?this.videoData.seek_forward_scrubbing++:this.videoData.seek_back_scrubbing++:e?this.videoData.seek_forward_click++:this.videoData.seek_back_click++,this.isSeeking=!1,this.isScrubbing=!1}}handlePlayingEvent(){M("Playing event for player "+this.id)}handlePauseEvent(){M("Pause event triggered for player "+this.id+"."),this.videoData.pause_cnt++,this.bufferStart=!1}handleSeekingEvent(e){this.lastPosition=this.player.getCurrentVideoTime(),this.lastPositionSincePlayTimeRecorded=this.lastPosition,M("Seek event triggered for player "+this.id+". new position is "+this.lastPosition),this.isSeeking?this.isScrubbing||(this.isScrubbing=!0):this.isSeeking=!0}handleSeekedEvent(e){this.lastPosition=this.player.getCurrentVideoTime(),this.lastPositionSincePlayTimeRecorded=this.lastPosition,M("Seeked event triggered for player "+this.id+". new position is "+this.lastPosition),this.videoData.seek_time+=this.player.getCurrentVideoTime()-this.initialSeekTime}handleWaitingEvent(e){M("Waiting event triggered for player "+this.id+"."),M("Waiting isBuffering"+this.isBuffering+" and isScrubbing "+this.isScrubbing),!1===this.isBuffering&&!1===this.isScrubbing&&(this.bufferStart=new Date,M("This is our buffer start"+this.bufferStart),this.bufferPosition=this.player.getCurrentVideoTime(),this.readyState=this.player.getReadyState())}handleCompleteEvent(){M("Complete event triggered for player "+this.id+".");var e=this.videoData;if(this.clearBufferingData(),!e.completed){var t=e.uuid;e.completed=!0,this.videoPixels.addCompleted(t),e.end&&e.end.played&&!e.end.added&&(e.end.added=!0,this.videoPixels.addViewed(t,"end",e.end.viewed),this.videoPixels.addHeard(t,"end",e.end.heard),this.videoPixels.fire())}}handleErrorEvent(e){M("Error event triggered for player "+this.id+"."),this.videoData.errored||(this.videoData.errored=!0,this.videoPixels.addErrored(this.videoData.uuid))}handleRemoveEvent(){M("Remove event triggered for player "+this.id+"."),this.videoData.removed||(this.videoData.removed=!0,this.videoPixels.addRemoved(this.videoData.uuid))}handleTimeEvent(e){if(!("start"in this.videoData))return;this.videoData.timeupdatecalls+=1;var t=this.player.getCurrentVideoTime(),i=this.player.getPlayerViewable(),a=!1|(this.player.getPlayerVolume()>=.02&&!this.player.getPlayerMute()),d=this.player.getVideoLength(),s=this.videoData;if(this.bufferStart&&t!==this.bufferPosition){M("Adding to lag time and bufferer count"),this.bufferEnd=new Date;const e=this.bufferEnd-this.bufferStart;this.bufferStart=!1,this.bufferPosition=!1,this.bufferCount++,1==this.bufferCount&&(M("Add data to initialBufferTime"),s.initialBufferingTime=+e),s.lagTime+=e}void 0===this.lastPosition&&(this.lastPosition=t,this.lastPositionSincePlayTimeRecorded=t);let r=t<this.lastPosition,n=this.lastPositionSincePlayTimeRecorded>this.lastPosition,o=t-this.lastPosition>1;(r||n||o)&&(M("somehow we failed to account for a seek event. compensating. "+r+" "+n+" "+o),this.lastPosition=t,this.lastPositionSincePlayTimeRecorded=t),s.total_play_time+=Math.floor(1e3*(this.lastPosition-this.lastPositionSincePlayTimeRecorded)),a&&s.timeupdatecalls>1&&(s.unmute=1,s.total_play_time_unmute+=Math.floor(1e3*(this.lastPosition-this.lastPositionSincePlayTimeRecorded)),M("total play time unmute is "+s.total_play_time_unmute+" call "+s.timeupdatecalls),void 0===s.video_unmute_start&&(s.video_unmute_start=B())),1<=t&&t<d/4?(M("Player "+this.id+" at start. Current position is "+t+"."),s.start.played=!0,s.start.viewed&=i,s.start.heard&=a):d/4<=t&&t<d/2?(M("Player "+this.id+" at first quartile. Current position is "+t+"."),s.firstQuartile.played=!0,s.firstQuartile.viewed&=i,s.firstQuartile.heard&=a):d/2<=t&&t<d/4*3?(M("Player "+this.id+" at middle. Current position is "+t+"."),s.middle.played=!0,s.middle.viewed&=i,s.middle.heard&=a):d/4*3<=t&&t<d-1?(M("Player "+this.id+" at third quartile. Current position is "+t+"."),s.thirdQuartile.played=!0,s.thirdQuartile.viewed&=i,s.thirdQuartile.heard&=a):d-1<=t&&(M("Player "+this.id+" at end. Current position is "+t+"."),s.end.played=!0,s.end.viewed&=i,s.end.heard&=a),!s.start.completed&&t>=1?(M("Player "+this.id+" played past start."),s.start.completed=!0,this.videoPixels.addQuartileData(),this.videoPixels.fire()):!s.firstQuartile.completed&&t>=1+d/4?(M("Player "+this.id+" played past first quartile."),s.firstQuartile.completed=!0,this.videoPixels.addQuartileData(),this.videoPixels.fire()):!s.middle.completed&&t>=1+d/2?(M("Player "+this.id+" played past middle."),s.middle.completed=!0,this.videoPixels.addQuartileData(),this.videoPixels.fire()):!s.thirdQuartile.completed&&t>=1+d/4*3&&(M("Player "+this.id+" played past third quartile."),s.thirdQuartile.completed=!0,this.videoPixels.addQuartileData(),this.videoPixels.fire()),Math.abs(t-this.lastPosition)>1&&(this.initialSeekTime=this.lastPosition),this.lastPositionSincePlayTimeRecorded=this.lastPosition,this.lastPosition=t}handleAdStarted(){if(this.bufferStart){this.bufferEnd=new Date;const e=this.bufferEnd-this.bufferStart;this.bufferStart=!1,this.bufferPosition=!1,this.bufferCount++,1==this.bufferCount&&(M("Add data to initialBufferTime"),this.videoData.initialBufferingTime=+e),this.videoData.lagTime+=e}}handleFloatPlayerClosed(){this.videoData.floatPlayerClosed=1,this.startDate&&(this.videoData.floatCloseTime=Date.now()-this.startDate)}handleFloatBounce(){let e=Date.now()-this.startDate;this.startDate&&this.is_floating&&!this.videoData.floatPlayerClosed&&this.player.isCurrentlyFloating()&&e<15e3&&(M("Float bounce"),this.videoPixels.addFloatBounce(this.videoData.uuid))}handleResolutionChange(){let e=this.player.player.player;if(!e)return;let t=e.qualityLevels(),i=t[t.selectedIndex];if(!i)return;let a=i.width.toString()+"x"+i.height.toString();this.videoData.resolutionStart||(this.videoData.resolutionStart=a,this.videoData.resolutionMax=a,this.videoData.resolutionPrevWidth=i.width,this.videoData.resolutionMaxWidth=i.width),i.width!=this.videoData.resolutionPrevWidth&&(this.videoData.resolutionPrevWidth=i.width,this.videoData.resolutionLastSelected=a),i.width>this.videoData.resolutionMaxWidth&&(this.videoData.resolutionMaxWidth=i.width,this.videoData.resolutionMax=a)}handleClickThroughToHumixPageEvent(){this.videoData.click_to_dedicated_page=1}handleSharingEvent(e){if(!e.platform)return;let t=this.videoData;this.videoData[e.platform]="number"!==typeof t.sharingData[e.platform]?1:t.sharingData[e.platform]++}handleVolumeChangeEvent(e){let t=this.player.player.player,i=t.muted()||0===t.volume();if(0===t.currentTime())this.videoData.muted=!!i;else{let e=this.videoData.muted;!i&&e?(this.videoData.unmute=1,this.videoData.video_unmute_start=B(),this.videoData.muted=!1):i&&!e&&(this.videoData.muted=!0)}}handleLightsToggle(e,t){this.videoData.lightsOff||(this.videoData.lightsOff=0),this.videoData.lightsOn||(this.videoData.lightsOn=0),t?this.videoData.lightsOn++:this.videoData.lightsOff++}handleCaptionToggle(){this.player.player.player&&(document.getElementsByClassName("vjs-text-track-cue").length>0?this.videoData.IsCaptionOn=1:this.videoData.IsCaptionOn=0)}}function M(e){"2"===new URLSearchParams(window.location.search).get("ez_vid_debug")&&console.log("[Video Analytics] "+e)}function B(){return(new Date).toISOString().substring(0,19).replace("T"," ")}class V{constructor(e){this.videoData=e}addCounts(){var e=this.videoData,t=e.uuid;if(e.play_cnt>0&&__ez.vep.Add(t,[new __ezDotData("play_cnt",e.play_cnt)]),e.pause_cnt>0&&__ez.vep.Add(t,[new __ezDotData("pause_cnt",e.pause_cnt)]),e.ad_cnt>0&&__ez.vep.Add(t,[new __ezDotData("ad_cnt",e.ad_cnt)]),e.seek_time>0){var i=0|e.seek_time;__ez.vep.Add(t,[new __ezDotData("seek_time",i)])}}addBufferData(){var e=this.videoData,t=e.uuid;e.total_play_time>0&&__ez.vep.Add(t,[new __ezDotData("total_play_time",e.total_play_time)]),e.initialBufferTime>0&&__ez.vep.Add(t,[new __ezDotData("init_buffer_time",e.initialBufferingTime)]),e.lagTime>0&&__ez.vep.Add(t,[new __ezDotData("lag_length",e.lagTime)])}addQuartileData(){var e=this.videoData;if("start"in e){var t=e.uuid;!e.start.added&&e.start.played&&e.start.completed&&(e.start.added=!0,this.addViewed(t,"start",e.start.viewed),this.addHeard(t,"start",e.start.heard)),!e.firstQuartile.added&&e.firstQuartile.played&&e.firstQuartile.completed&&(e.firstQuartile.added=!0,this.addViewed(t,"first_quartile",e.firstQuartile.viewed),this.addHeard(t,"first_quartile",e.firstQuartile.heard)),!e.middle.added&&e.middle.played&&e.middle.completed&&(e.middle.added=!0,this.addViewed(t,"middle",e.middle.viewed),this.addHeard(t,"middle",e.middle.heard)),!e.thirdQuartile.added&&e.thirdQuartile.played&&e.thirdQuartile.completed&&(e.thirdQuartile.added=!0,this.addViewed(t,"third_quartile",e.thirdQuartile.viewed),this.addHeard(t,"third_quartile",e.thirdQuartile.heard))}}addFloatPlayerClosed(){void 0!==this.videoData.floatPlayerClosed&&this.videoData.floatPlayerClosed>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("float_player_closed",this.videoData.floatPlayerClosed)]),this.videoData.floatCloseTime&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("float_close_time",this.videoData.floatCloseTime)])}addResolutionData(){void 0!==this.videoData.resolutionStart&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("resolution_start",this.videoData.resolutionStart)]),void 0!==this.videoData.resolutionMax&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("resolution_max",this.videoData.resolutionMax)]),void 0!==this.videoData.resolutionLastSelected&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("resolution_last_selected",this.videoData.resolutionLastSelected)])}addTitleClickData(){void 0!==this.videoData.click_to_dedicated_page&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("click_to_dedicated_page",this.videoData.click_to_dedicated_page)])}addMuteData(){void 0!==this.videoData.unmute&&(__ez.vep.Add(this.videoData.uuid,[new __ezDotData("unmute",this.videoData.unmute)]),__ez.vep.Add(this.videoData.uuid,[new __ezDotData("video_unmute_start",this.videoData.video_unmute_start)])),this.videoData.total_play_time_unmute>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("total_play_time_unmute",this.videoData.total_play_time_unmute)])}addStart(e){var t=(new Date).toISOString().substring(0,19).replace("T"," ");__ez.vep.Add(e,[new __ezDotData("video_start",t)])}addCompleted(e){__ez.vep.Add(e,[new __ezDotData("completed",1)])}addErrored(e){__ez.vep.Add(e,[new __ezDotData("errored",1)])}addRemoved(e){__ez.vep.Add(e,[new __ezDotData("removed",1)])}addViewed(e,t,i){__ez.vep.Add(e,[new __ezDotData("viewed_"+t,i)])}addHeard(e,t,i){__ez.vep.Add(e,[new __ezDotData("heard_"+t,i)])}addClickedLink(e,t){let{href:i}=t;var a=this.videoData.uuid;__ez.vep.Add(a,[new __ezDotData("clicked_link_s",e)]),i&&__ez.vep.Add(a,[new __ezDotData("clicked_link_url",i)])}addSharingData(){let e=this.videoData,t=e.uuid,i={fbButton:"facebook_shares",pinterest:"pinterest_shares",tw:"twitter_shares",reddit:"reddit_shares",googleplus:"googleplus_shares",messenger:"messenger_shares",linkedin:"linkedin_shares",vk:"vk_shares",ok:"ok_shares",mail:"mail_shares",email:"email_shares",telegram:"telegram_shares",whatsapp:"whatsapp_shares",viber:"viber_shares"};Object.keys(e.sharingData).forEach((a=>{i.hasOwnProperty(a)&&e.sharingData[a]>0&&(i[a],e.sharingData[a],__ez.vep.Add(t,[new __ezDotData(i[a],e.sharingData[a])]))}))}addLightsData(){this.videoData.lightsOn&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("lights_on",this.videoData.lightsOn)]),this.videoData.lightsOff&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("lights_off",this.videoData.lightsOff)])}addFloatBounce(e){__ez.vep.Add(e,[new __ezDotData("float_bounce",1)])}fire(){__ez.vep.Fire()}addSeekData(){this.videoData.seek_back_click>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("seek_back_click",this.videoData.seek_back_click)]),this.videoData.seek_forward_click>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("seek_forward_click",this.videoData.seek_forward_click)]),this.videoData.seek_back_scrubbing>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("seek_back_scrubbing",this.videoData.seek_back_scrubbing)]),this.videoData.seek_forward_scrubbing>0&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("seek_forward_scrubbing",this.videoData.seek_forward_scrubbing)])}addPixel(e,t){__ez.vep.Add(this.videoData.uuid,[new __ezDotData(e,t)])}addCaptionOnOffData(){void 0!==this.videoData.IsCaptionOn&&__ez.vep.Add(this.videoData.uuid,[new __ezDotData("is_caption_on",this.videoData.IsCaptionOn)])}}class O{constructor(e,t){!0===t.Preview||(this.vidStorePath="/detroitchicago/vid.gif",this.vidErrorURL=(1==window._ez_send_requests_outside_humix||window.hasOwnProperty("ezIntType")&&"wp"===window.ezIntType||"undefined"!==typeof _ez_send_requests_through_ezoic&&!0===_ez_send_requests_through_ezoic||window._ez_sa?"https://g.ezoic.net":window.location.protocol+"//"+document.location.hostname)+"/detroitchicago/ved.gif",this.url=_ezaq.url,this.pageview_id=_ezaq.page_view_id,_ezaq.hasOwnProperty(["visit_uuid"])?this.visit_uuid=_ezaq.visit_uuid:this.visit_uuid=i("ezovuuid_"+_ezaq.domain_id),this.template_id=_ezaq.template_id,this.domain_id=_ezaq.domain_id,this.tech=e.getTech(),this.is_humix_app=window.is_humix_app?1:0,"undefined"!==typeof vectx&&(vectx.hasOwnProperty("video_container_impression_id")&&(this.video_container_impression_id=vectx.video_container_impression_id),vectx.hasOwnProperty("embed_is_floating")&&(this.embed_is_floating=vectx.embed_is_floating)),this.eventEmitter=e.getEventEmitter(),this.player=e,this.playerEvents=[],this.videoObject=t,this.setVideoData(t,!0))}setVideoData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.videoData;this.videoData=a(),this.videoData.impression_id=e.ImpressionId,this.videoData.ad_unit=e.AdUnit,"undefined"!==typeof this.player.player.player.ezErrorState&&(this.videoData.uuid,"undefined"===typeof this.player.player.player.errored&&(this.videoData.uuid,this.videoData.errored=!1)),this.owner_domain_id=void 0,this.extra_message=void 0,e&&e.PublisherVideoContentShare&&Object.keys(e.PublisherVideoContentShare).length>0&&d(e.PublisherVideoContentShare)&&(d(e.PublisherVideoContentShare)&&(this.owner_domain_id=e.PublisherVideoContentShare.DomainIdOwner),"undefined"!==typeof e.PublisherVideoContentShare.LoadError&&(this.extra_message=e.PublisherVideoContentShare.LoadError)),this.humix_channel_id=e.HumixChannelId,this.media_src=this.player.getMediaSource(),this.width=this.player.getVideoDimensions().width,this.height=this.player.getVideoDimensions().height,this.id=this.videoData.uuid,void 0!==this.player.player.player.title&&(this.video_title=this.player.player.player.title),void 0!==this.player.player.player.video_position_id&&(this.video_position_id=this.player.player.player.video_position_id),void 0!==this.player.player.player.is_autoplay&&(this.is_autoplay=this.player.player.player.is_autoplay?1:0),void 0!==this.player.player.player.is_floating&&(this.is_floating=this.player.player.player.is_floating?1:0),"undefined"!==typeof this.player.player.player.videos?(this.is_playlist_item=1,this.video_playlist_id=e.VideoPlaylistId,this.video_playlist_index=this.player.player.player.videos.findIndex((t=>t.VideoContentId===e.VideoContentId))):this.is_playlist_item=0,e.videoObjectsCount&&(this.video_objects_count=e.videoObjectsCount),e.videoObjectsIndex&&(this.video_objects_index=e.videoObjectsIndex),void 0!==this.player.player.player.video_length&&(this.video_length=this.player.player.player.video_length),void 0!==e.VideoSelection&&(this.video_selection_type=e.VideoSelection),e.VideoMatchScore&&(this.video_match_score=e.VideoMatchScore),e.VideoAutoMatchType&&(this.video_auto_match_type=e.VideoAutoMatchType),e.VideoUploadSource&&e.VideoUploadSource.length>0?this.video_source=e.VideoUploadSource:this.video_source="upload",this.videoData.total_play_time_unmute=0,e.CollectionId&&e.ScoreGroupId&&(this.collection_id=e.CollectionId,this.score_group_id=e.ScoreGroupId),e.VideoRankingConfigId&&(this.video_ranking_config_id=e.VideoRankingConfigId),e.PreferredVideoType&&(this.preferred_video_type=e.PreferredVideoType),void 0!==e.AutoInsertImpressionID&&""!=e.AutoInsertImpressionID&&(this.video_auto_insert_impression_id=e.AutoInsertImpressionID),void 0!==e.embed_ctx&&(void 0!==e.embed_ctx.parent_url&&(this.url=e.embed_ctx.parent_url),void 0!==e.embed_ctx.domain_id&&(this.domain_id=e.embed_ctx.domain_id,this.pageview_id=e.embed_ctx.pageview_id,this.visit_uuid=e.embed_ctx.visit_uuid)),this.is_vertical=e.IsVertical||e.IsRotate?1:0,this._ezva=[],this.storeData(),this.generateBufferData(this.videoData),this.is_floating?this.videoData.floatPlayerClosed=i?i.floatPlayerClosed:0:this.videoData.floatPlayerClosed=void 0,this.generateSharingData(this.videoData),this.bufferStart=!1,this.bufferEnd=!1,this.bufferCount=0,this.readyState=!1,this.timer=null,this.isSeeking=!1,this.isScrubbing=!1,this.isBuffering=!1,this.initialSeekTime=0,this.videoPixels=new V(this.videoData),this.videoEvents=new L,t&&this.attachListeners(),this.reattachListeners()}attachListeners(){"HTML5"===this.tech?this.attachHTML5Listeners():"YOUTUBE"===this.tech?this.attachYoutubeListeners():"VIMEO"===this.tech&&this.attachVimeoListeners(),ez_attachEvent(document,"blur",this.bind_(this,this.unloadAll)),ez_attachEvent(window,"beforeunload",this.bind_(this,this.unloadAll)),ez_attachEvent(window,"blur",this.bind_(this,this.unloadAll)),ez_attachEvent(window,"pagehide",this.bind_(this,this.unloadAll)),ez_attachEvent(window,"unload",this.bind_(this,this.unloadAll)),ez_attachEvent(window,"beforeunload",this.bind_(this,this.videoEvents.handleFloatBounce)),this.attachSharingListeners()}attachHTML5Listeners(){this.playerEvents=[{name:"play",fn:this.bind_(this,this.videoEvents.handleInitialPlay)},{name:"play",fn:this.bind_(this,this.videoEvents.handlePlayEvent)},{name:"pause",fn:this.bind_(this,this.videoEvents.handlePauseEvent)},{name:"seeking",fn:this.bind_(this,this.videoEvents.handleSeekingEvent)},{name:"seeked",fn:this.bind_(this,this.videoEvents.handleSeekedEvent)},{name:"ended",fn:this.bind_(this,this.videoEvents.handleCompleteEvent)},{name:"error",fn:this.bind_(this,this.videoEvents.handleErrorEvent)},{name:"remove",fn:this.bind_(this,this.videoEvents.handleRemoveEvent)},{name:"timeupdate",fn:this.bind_(this,this.videoEvents.handleTimeEvent)},{name:"waiting",fn:this.bind_(this,this.videoEvents.handleWaitingEvent)},{name:"playing",fn:this.bind_(this,this.videoEvents.handlePlayingEvent)},{name:"ads-ad-started",fn:this.bind_(this,this.videoEvents.handleAdStarted)},{name:"floatPlayerClosed",fn:this.bind_(this,this.videoEvents.handleFloatPlayerClosed)},{name:"resolutionChange",fn:this.bind_(this,this.videoEvents.handleResolutionChange)},{name:"clickThroughToHumixPage",fn:this.bind_(this,this.videoEvents.handleClickThroughToHumixPageEvent)},{name:"volumechange",fn:this.bind_(this,this.videoEvents.handleVolumeChangeEvent)},{name:"captionToggle",fn:this.bind_(this,this.videoEvents.handleCaptionToggle)}],this.playerEvents.forEach((e=>{this.eventEmitter.on(e.name,e.fn)}))}attachYoutubeListeners(){}attachVimeoListeners(){}reattachListeners(){"HTML5"===this.tech?(this.detachHTML5Listeners(),this.attachHTML5Listeners()):"YOUTUBE"===this.tech?(this.detachYoutubeListeners(),this.attachYoutubeListeners()):"VIMEO"===this.tech&&(this.detachVimeoListeners(),this.attachVimeoListeners())}detachHTML5Listeners(){this.playerEvents.forEach((e=>{this.eventEmitter.off(e.name,e.fn)}))}detachYoutubeListeners(){}detachVimeoListeners(){}attachSharingListeners(){this.player&&this.player.on(null,"sharing:social:clicked",this.bind_(this,this.videoEvents.handleSharingEvent))}unloadAll(){this.videoPixels.addCounts(),this.videoPixels.addQuartileData(),this.videoPixels.addBufferData(),this.videoPixels.addFloatPlayerClosed(),this.videoPixels.addResolutionData(),this.videoPixels.addTitleClickData(),this.videoPixels.addSharingData(),this.videoPixels.addLightsData(),this.videoPixels.addMuteData(),this.videoPixels.addSeekData(),this.videoPixels.addCaptionOnOffData(),this.videoPixels.addPixel("timeupdatecalls",this.videoData.timeupdatecalls),this.videoPixels.fire()}handleClickLink(e,t){this.videoPixels.addClickedLink(e,t),this.videoPixels.fire()}clearBufferingData(){this.timer&&clearTimeout(this.timer),this.isScrubbing=!1,this.bufferPosition=!1,this.bufferStart=!1,this.bufferEnd=!1,this.readyState=!1}storeData(){if(("undefined"===typeof __ezInstream||!0!==__ezInstream.genericInstream)&&(this._ezva.push(this.getInitVideoData()),this._ezva.length>0)){JSON.stringify(this._ezva);var e=__ez.dot.getURL(this.vidStorePath);__ez.dot.Fire(e,this._ezva)}}generateBufferData(e){e.initialBufferingTime=0,e.initialSeekTime=0,e.lagTime=0,e.averageBitRate=0}generateSharingData(e){e.sharingData={fbButton:0,tw:0,reddit:0,linkedin:0,vk:0,email:0,telegram:0,whatsapp:0,pinterest:0}}generateQuartileData(e,t){e.start={},e.start.viewed=!0,e.start.heard=!0,e.start.played=!1,e.start.completed=!1,e.start.added=!1,e.firstQuartile={},e.firstQuartile.time=t/4|0,e.firstQuartile.viewed=!0,e.firstQuartile.heard=!0,e.firstQuartile.played=!1,e.firstQuartile.completed=!1,e.firstQuartile.added=!1,e.middle={},e.middle.time=t/2|0,e.middle.viewed=!0,e.middle.heard=!0,e.middle.played=!1,e.middle.completed=!1,e.middle.added=!1,e.thirdQuartile={},e.thirdQuartile.time=3*t/4|0,e.thirdQuartile.viewed=!0,e.thirdQuartile.heard=!0,e.thirdQuartile.played=!1,e.thirdQuartile.completed=!1,e.thirdQuartile.added=!1,e.end={},e.end.viewed=!0,e.end.heard=!0,e.end.played=!1,e.end.added=!1}getInitVideoData(){var e={};e.domain_id=this.domain_id,void 0!==this.owner_domain_id&&(e.owner_domain_id=this.owner_domain_id),e.humix_channel_id=this.humix_channel_id,e.url=this.url,e.pageview_id=this.pageview_id,e.visit_uuid=this.visit_uuid,e.template_id=this.template_id,e.video_impression_id=this.videoData.uuid,e.media_src=this.media_src,e.player_type=this.player.getPlayerType(),e.video_title=this.video_title,e.video_position_id=this.video_position_id,e.is_autoplay=this.is_autoplay,e.is_floating=this.is_floating,e.is_playlist_item=this.is_playlist_item,e.ab_test_id=_ezaq.ab_test_id,e.vab_test_id=_ezaq.ab_test_id,"undefined"!==typeof this.videoObject&&(e.is_preferred=this.videoObject.IsPreferred),this.is_playlist_item&&(e.video_playlist_id=this.video_playlist_id,e.video_playlist_index=this.video_playlist_index),e.video_length=this.video_length,void 0!==this.player.player.player.ezVideoId&&(e.content_id=this.player.player.player.ezVideoId),this.player.player.player.ezVideoImpressionId=e.video_impression_id,this.player.player.player.ezVideoImpressionId,e.width=this.width,e.height=this.height;var t=this.player.getPlayerPosition();e.pos_x=Math.round(t.x),e.pos_y=Math.round(t.y),this.video_objects_count&&(e.video_objects_count=this.video_objects_count),this.video_objects_index&&(e.video_objects_index=this.video_objects_index),this.extra_message&&(e.extra_message=this.extra_message),void 0!==this.video_selection_type&&(e.video_selection_type=this.video_selection_type),void 0!==this.video_match_score&&(e.video_match_score=this.video_match_score),void 0!==this.video_auto_match_type&&(e.video_auto_match_type=this.video_auto_match_type),e.is_blocker_on=function(){try{google.ima}catch(e){return!1}return!!__ez.vhb}()?0:1,void 0!==this.video_source&&(e.video_source=this.video_source),void 0!==this.video_container_impression_id&&(e.video_container_impression_id=this.video_container_impression_id),void 0!==this.embed_is_floating&&(e.embed_is_floating=this.embed_is_floating),void 0!==this.score_group_id&&void 0!==this.collection_id&&(e.score_group_id=this.score_group_id,e.collection_id=this.collection_id),void 0!==this.video_ranking_config_id&&(e.video_ranking_config_id=this.video_ranking_config_id),void 0!==this.video_auto_insert_impression_id&&(e.video_auto_insert_impression_id=this.video_auto_insert_impression_id),e.is_humix_app=this.is_humix_app,e.preferred_video_type=this.preferred_video_type;var i=t.x/window._hmx.topWindowBridge.getTopWindowInnerWidth();i&&!isNaN(i)&&i>0&&(e.pos_x_ratio=i);var a=t.y/window._hmx.topWindowBridge.getTopWindowInnerHeight();return a&&!isNaN(a)&&a>0&&(e.pos_y_ratio=a),e.insert_method=this.player.getInsertMethod(),e.is_vertical=this.is_vertical,window.ezoIframeStartTime&&(e.iframe_fire_delay_millis=Math.round(performance.now()-window.ezoIframeStartTime)),window.ezVideoIframe&&window._hmx&&window._hmx.topWindowBridge&&window._hmx.topWindowBridge.getElapsedTimeSinceIframeWasCreated&&window._hmx.topWindowBridge.getElapsedTimeSinceIframeWasCreated()&&!isNaN(window._hmx.topWindowBridge.getElapsedTimeSinceIframeWasCreated())&&(e.iframe_created_delay_millis=Math.round(window._hmx.topWindowBridge.getElapsedTimeSinceIframeWasCreated())),e}getVideoImpressionUUID(){return this.videoData&&this.videoData.uuid?this.videoData.uuid:""}bind_(e,t){return function(){t.apply(e,arguments)}}}class R{constructor(){"undefined"!==typeof afterglow.players&&(this.player=afterglow.getPlayer(afterglow.players[0].id)),this.playerId=afterglow.players[0].id}on(e,t,i){afterglow.on(this.playerId,t,i)}off(e,t,i){afterglow.off(this.playerId,t,i)}onTimeUpdate(e){}offTimeUpdate(e){}isFullscreen(){return!1}requestFullscreen(){}exitFullscreen(){}getVideoElement(){return afterglow.getPlayer(this.playerId).el_}getEventEmitter(){return afterglow.getPlayer(this.playerId)}getTech(){return this.player.techName_.toUpperCase()}getPlayer(){return afterglow.getPlayer(this.playerId)}getMediaSource(){return this.player.src()}isMobilePlatform(){return this.player.paused&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)}preloadContent(e){this.isMobilePlatform()?(this.preloadListener_=e,this.player.addEventListener("loadedmetadata",e,!1),this.player.load()):e()}removePreloadListener(){this.preloadListener_&&(this.player.removeEventListener("loadedmetadata",this.preloadListener_,!1),this.preloadListener_=null)}getVideoLength(){return this.player.duration()}isPlayerAutoplay(){return this.player.autoplay()}getVideoContainer(){return this.player.el_}getPlayerPosition(){var e={x:-1,y:-1},t=this.getVideoContainer();if("undefined"!==typeof t){var i=getElementPosition(t);e.x=i.x,e.y=i.y}return e}getVideoDimensions(){var e={width:-1,height:-1},t=this.getVideoContainer();return e.width=t.width,e.height=t.height,e}getPlayerVolume(){return this.player.volume()}setPlayerVolume(e){}getPlayerViewable(){return!1}getCurrentTime(){return this.player.currentTime()}getPlayerMute(){return this.player.muted()}play(){this.player.play()}pause(){this.player.pause()}paused(){}}class U{constructor(){"undefined"!==typeof flowplayer.Players&&(this.player=flowplayer.Players.instances[0])}on(e,t,i){this.player.on(t,i)}off(e,t,i){this.player.off(t,i)}onTimeUpdate(e){}offTimeUpdate(e){}isFullscreen(){return!1}requestFullscreen(){}exitFullscreen(){}getVideoElement(){return this.player}getEventEmitter(){return this.getVideoElement()}getTech(){return"HTML5"}getPlayer(){return this.player}getMediaSource(){return this.player.currentSrc}isMobilePlatform(){return this.player.paused&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)}preloadContent(e){this.isMobilePlatform()?(this.preloadListener_=e,this.player.addEventListener("loadedmetadata",e,!1),this.player.load()):e()}removePreloadListener(){this.preloadListener_&&(this.player.removeEventListener("loadedmetadata",this.preloadListener_,!1),this.preloadListener_=null)}getVideoLength(){return this.player.duration}isPlayerAutoplay(){return!1}getVideoContainer(){return this.player}getPlayerPosition(){var e={x:-1,y:-1},t=this.getVideoContainer();if("undefined"!==typeof t){var i=getElementPosition(t);e.x=i.x,e.y=i.y}return e}getVideoDimensions(){var e={width:-1,height:-1};return videoContainer=this.getVideoContainer(),e.width=videoContainer.width,e.height=videoContainer.height,e}getPlayerVolume(){return this.player.volume}setPlayerVolume(e){}getPlayerViewable(){return this.player.in_viewport}getPlayerMute(){return this.player.muted}play(){this.player.play()}pause(){this.player.pause()}paused(){}}class F{constructor(e){this.player=jwplayer(e)}on(e,t,i){this.player.on(t,i)}off(e,t,i){this.player.off(t,i)}onTimeUpdate(e){}offTimeUpdate(e){}isFullscreen(){return!1}requestFullscreen(){}exitFullscreen(){}getVideoElement(){return this.player}getEventEmitter(){return this.getVideoElement()}getTech(){return this.player.getProvider()}getPlayer(){return this.player}getMediaSource(){return this.player.Playlist.file}isMobilePlatform(){return this.player.paused&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)}preloadContent(e){this.isMobilePlatform()?(this.preloadListener_=e,this.player.addEventListener("loadedmetadata",e,!1),this.player.load()):e()}removePreloadListener(){this.preloadListener_&&(this.player.removeEventListener("loadedmetadata",this.preloadListener_,!1),this.preloadListener_=null)}getVideoLength(){return this.player.getDuration()}isPlayerAutoplay(){return!1}getVideoContainer(){return this.player}getPlayerPosition(){var e={x:-1,y:-1},t=this.getVideoContainer();if("undefined"!==typeof t){var i=getElementPosition(t);e.x=i.x,e.y=i.y}return e}getVideoDimensions(){var e={width:-1,height:-1};return videoContainer=this.getVideoContainer(),e.width=videoContainer.width,e.height=videoContainer.height,e}getPlayerVolume(){return this.player.getVolume()}setPlayerVolume(e){}getPlayerViewable(){return this.player.getViewable()}getPlayerMute(){return this.player.getMute()}play(){this.player.play()}pause(){this.player.pause()}paused(){}}class H{constructor(e){if(this.player={},"undefined"!==typeof e)this.player=e;else{var t=videojs.getAllPlayers();t.length>0&&(this.player=t[0])}}on(e,t,i){this.player.on(t,i)}off(e,t,i){this.player.off(t,i)}once(e,t,i){this.player.one(t,i)}ended(){return this.player.ended()}trigger(e){this.player.trigger(e)}onTimeUpdate(e){this.on(null,"timeupdate",e)}offTimeUpdate(e){this.off(null,"timeupdate",e)}isFullscreen(){return this.player.isFullscreen()}requestFullscreen(){this.player.requestFullscreen()}exitFullscreen(){this.player.exitFullscreen()}getReadyState(){return this.player.readyState()}getVideoElement(){return this.player.tech({IWillNotUseThisInPlugins:!0}).el()}getEventEmitter(){return this.player}getTech(){return"HTML5"}getPlayer(){return this.player}getMediaSource(){return this.player.currentSrc()}isMobilePlatform(){return this.player.paused()&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)}preloadContent(e){this.isMobilePlatform()?(this.preloadListener_=e,this.player.addEventListener("loadedmetadata",e,!1),this.player.load()):e()}removePreloadListener(){this.preloadListener_&&(this.player.removeEventListener("loadedmetadata",this.preloadListener_,!1),this.preloadListener_=null)}getVideoLength(){return this.player.duration()}isPlayerAutoplay(){return this.player.is_autoplay?this.player.is_autoplay:this.player.autoplay()}getVideoContainer(){return this.player.el()}getPlayerPosition(){var e={x:-1,y:-1},t=this.getVideoContainer();if("undefined"!==typeof t){var i=getElementPosition(t);e.x=i.x,e.y=i.y}return e}getVideoDimensions(){var e={width:-1,height:-1},t=this.getVideoContainer();return e.width=t.clientWidth,e.height=t.clientHeight,e}getPlayerVolume(){return this.player.volume()}setPlayerVolume(e){this.player.volume(e),0==e?this.player.muted(!0):this.player.muted(!1)}getPlayerViewable(){return!1}getPlayerMute(){return this.player.muted()}getCurrentTime(){return this.player.currentTime()}play(){this.player.play()}pause(){this.player.pause()}paused(){return this.player.paused()}}class q{constructor(e,t){this.playerDef=e,this.playerObject=t}getPlayer(){return"afterglow"===this.playerDef?new R:"flowplayer"===this.playerDef?new U:"jwplayer"===this.playerDef?new F(0):"videojs"===this.playerDef||"ezvideojs"===this.playerDef?new H(this.playerObject):void 0}}class j{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;u(this,"analytics",null),u(this,"adAnalytics",null),u(this,"videoContentShare",null),u(this,"adInitializer",null),u(this,"adRenderer",null);let a=new q(e,i);this.playerDef=e,this.player=a.getPlayer(),this.videoPlayerContainer_=this.getVideoContainer(),this.dimensions=this.player.getVideoDimensions(),this.preloadListener_=null,this.PlayPromise=null,this.currentTime=0,this.width=this.dimensions.width,this.height=this.dimensions.height,this.videoObject=t,this.userPaused_=!1;let d=this;i.playVideoOrAd=async function(){return new Promise((e=>{this.isAdInProgress()&&this.isAdPaused()?d.adRenderer.resumeAd():this.isAdInProgress()||this.play(),e()}))},i.pauseVideoOrAd=async function(){return new Promise((e=>{this.isAdInProgress()&&!this.isAdPaused()?d.adRenderer.pauseAd():this.isAdInProgress()||this.pause(),e()}))},i.isAdInProgress=function(){let e=!!(d.adRenderer&&d.adRenderer.ads_&&d.adRenderer.ads_.adsManager_),t=!!(d.adRenderer&&d.adRenderer.adStrategy&&d.adRenderer.adStrategy.currentAd);return e||t},i.isAdPaused=function(){return d.adRenderer&&!d.adRenderer.isAdPlaying()},i.isCurrentlyFloating=function(){return d.isCurrentlyFloating()},i.isPausedByUser=function(){return d.isVideoOrAdPaused()&&d.userPaused_},i.getCurrentAdTime=function(){return d.adRenderer&&d.adRenderer.getCurrentAdProgress?d.adRenderer.getCurrentAdProgress():0};const s=e=>{e.target.closest(".ez-vad-play-pause, .vjs-play-control, .vjs-big-play-button, video")&&(this.userPaused_=this.isVideoOrAdPaused())};this.player.getVideoContainer().addEventListener("click",s),this.player.getVideoElement().addEventListener("click",s),this.on(null,"play",(()=>this.userPaused_=!1))}isVideoOrAdPaused(){return this.player.getPlayer().isAdInProgress()?this.player.getPlayer().isAdPaused():this.player.paused()}bind_(e,t){return function(){t.apply(e,arguments)}}on(e,t,i){this.player.on(e,t,i)}once(e,t,i){this.player.once(e,t,i)}off(e,t,i){this.player.off(e,t,i)}onTimeUpdate(e){this.player.onTimeUpdate(e)}offTimeUpdate(e){this.player.offTimeUpdate(e)}isFullscreen(){return this.player.isFullscreen()}requestFullscreen(){this.player.requestFullscreen()}exitFullscreen(){this.player.exitFullscreen()}toggleFullscreen(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()}getReadyState(){return this.player.getReadyState()}getVideoElement(){return this.player.getVideoElement()}getPlayerFromDef(){return this.player}getEventEmitter(){return this.player.getEventEmitter()}getTech(){return this.player.getTech()}getMediaSource(){return this.player.getMediaSource()}isMobilePlatform(){return this.player.paused&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)}getCurrentVideoTime(){return this.currentTime=this.player.getCurrentTime(),this.currentTime}handleAdPause(e){}preloadContent(e){this.isMobilePlatform()?(this.preloadListener_=e,this.player.on(null,"loadedmetadata",e),this.on(null,"adpause",this.bind_(this,this.handleAdPause))):e()}removePreloadListener(){this.preloadListener_&&(this.player.off(null,"loadedmetadata",this.preloadListener_),this.preloadListener_=null)}getPlayerType(){return 0==this.videoObject.MagicPlaceholderType?"default":"universal"}getVideoLength(){return this.player.getVideoLength()}isPlayerAutoplay(){return this.player.isPlayerAutoplay()}isCurrentlyFloating(){let e=this.player.player.id_.substring(9),t=document.getElementById("floating-placeholder-"+e);return!(!t||!t.style.display)&&"none"!==t.style.display}isEmbedCurrentlyFloating(){return!("undefined"===typeof vectx||!vectx.hasOwnProperty("player_currently_floating"))&&vectx.player_currently_floating}getVideoContainer(){return this.player.getVideoContainer()}getAdContainer(){let e=document.getElementById(this.adInitializer.videoAdContainerId);return e||(e=document.createElement("div")),e}getPlayerPosition(){var e={x:-1,y:-1},t=this.videoPlayerContainer_;if("undefined"!==typeof t){var i=this.getElementPosition(t);e.x=i.x,e.y=i.y}return e}getElementPosition(e){return window._hmx.topWindowBridge.getElementPosition(e)}getVideoDimensions(){return this.player.getVideoDimensions()}resize(e,t,i,a,d){this.videoPlayerContainer_.style.position=e,this.videoPlayerContainer_.style.top=t+"px",this.videoPlayerContainer_.style.left=i+"px",this.videoPlayerContainer_.style.width=a+"px",this.videoPlayerContainer_.style.height=d+"px",this.player.style.width=a+"px",this.player.style.height=d+"px"}resizeAdContainer(e,t,i,a,d){this.videoPlayerContainer_=this.getVideoContainer(),document.getElementById(this.adRenderer.adContainerId).style.width="100%"}registerVideoEndedCallback(e){this.player.on("my-video","ended",e)}removeVideoEndedCallback(e){this.player.off("my-video","ended",e)}getPlayerVolume(){return this.getPlayerMute()?0:this.player.getPlayerVolume()}setPlayerVolume(e){return this.player.setPlayerVolume(e)}getPlayerViewable(){return function(e,t){let i=window._hmx.topWindowBridge.getBoundingClientRectInTopWindow(e),a=window._hmx.topWindowBridge.getTopWindowInnerHeight();return!(Math.floor(100-(i.top>=0?0:i.top)/+-i.height*100)<t||Math.floor(100-(i.bottom-a)/i.height*100)<t)}(this.player.getVideoElement(),50)}getPlayerMute(){return this.player.getPlayerMute()}play(){return this.PlayPromise=this.player.play(),this.PlayPromise}pause(){this.player.pause()}paused(){return this.player.paused()}asyncPause(){this.player.trigger("asyncpause")}ended(){return this.player.ended()}trigger(e){this.player.trigger(e)}getNextAdBreak(e){if(0==e.length)return;const t=e[0];if(t.positionGen&&"FrontLoad"===t.positionGen)return this.getNextFrontloadedBreak(e);let i,a,d,s=Math.floor(this.getCurrentVideoTime()),r=-1;for(let n=0;n<e.length;n++){if("undefined"!==typeof e[n].isTriggered&&!0===e[n].isTriggered)continue;if("undefined"!==typeof e[n].IsSkipped&&!0===e[n].IsSkipped)continue;let t=this.getAdBreakTime(e[n]);r<t&&(r=t,a=e[n],d=n),t<=s&&!1===e[n].isComplete&&!1===this.getIsBreakCompleted(e[n])&&(d=n,i=e[n])}return i||(i=a),{nextBreak:i,idx:d}}getNextFrontloadedBreak(e){if(0===e.length)return;Math.floor(this.getCurrentVideoTime());let t,i,a=1/0;for(let d=0;d<e.length;d++){if(!0===e[d].isTriggered||!0===e[d].IsSkipped)continue;let s=this.getAdBreakTime(e[d]);!1===e[d].isComplete&&!1===this.getIsBreakCompleted(e[d])&&s<a&&(a=s,t=e[d],i=d)}return t?{nextBreak:t,idx:i}:void 0}getPrevAdBreak(e){if(0==e.length)return;let t,i=Math.floor(this.getCurrentVideoTime());for(let a=0;a<e.length;a++){let d=this.getAdBreakTime(e[a]);if(d==i){t=e[a];break}if(d>i){t=e[a-1];break}}return t||(t=e[e.length-1]),t}getAdBreakTime(e){let t=e.timeOffsetSeconds;return-1==t&&(t=Math.floor(this.getVideoLength())),t}attachAnalytics(e){return this.analytics=new O(this,e),this.analytics}attachAdAnalytics(e,t,i,a){return this.adAnalytics=new I(this,e,t,i,this.videoContentShare,a),this.adAnalytics}attachAdRendering(){let{adUnit:e,adBreaks:t,adInitializer:i,isPlayList:a,videoObject:d,browserPermissions:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.adInitializer=i,this.adRenderer=new z(this,e,t,i,a,d,s),this.adRenderer}attachPrebidAdRendering(){let{adUnit:e,adBreaks:t,adInitializer:i,videoObject:a,browserPermissions:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.adInitializer=i,"undefined"!==window.ezVadPb&&window.ezVadPb.PrebidVideoAdManager&&(this.adRenderer=new window.ezVadPb.PrebidVideoAdManager(this,e,t,a,d,i)),this.adRenderer}getInsertMethod(){return this.videoObject.InsertMethod}getIsBreakCompleted(e){return!!(__ez&&__ez.vhb&&__ez.vhb.breaks&&e&&e.key)&&__ez.vhb.breaks[e.key].isComplete}}let N=!1;function W(e,t){return new j(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0)}function Q(e,t,i,a){return new o(e,t,i,a)}function G(e,t,i,a){if("undefined"!==window.ezVadPb&&window.ezVadPb.PrebidVideoAdStrategy)return new window.ezVadPb.PrebidVideoAdStrategy(e,t,a)}"undefined"!==typeof ezVideoIframe&&ezVideoIframe&&(N=!0),"undefined"!==typeof isSharedEmbed&&isSharedEmbed&&(N=!1,"undefined"!==typeof vectx&&(vectx.hasOwnProperty("parent_url")&&(_ezaq.player_url=_ezaq.url,_ezaq.url=vectx.parent_url),vectx.hasOwnProperty("domain_id")&&(window._ez_send_requests_outside_humix=!0,_ezaq.domain_id=vectx.domain_id,_ezaq.page_view_id=vectx.pageview_id,_ezaq.visit_uuid=vectx.visit_uuid))),__ez=N?window.parent.__ez:__ez,_ezaq=N?window.parent._ezaq:_ezaq,ez_attachEvent=N?window.parent.ez_attachEvent:ez_attachEvent,ez_detachEvent=N?window.parent.ez_detachEvent:ez_detachEvent,__ezDotData=N?window.parent.__ezDotData:__ezDotData,ezVideoAnalytics=t})();